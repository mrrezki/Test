(self.webpackChunk_jupyterlab_git=self.webpackChunk_jupyterlab_git||[]).push([[664],{8082:(e,t,s)=>{"use strict";s.r(t),s.d(t,{DiffModel:()=>v,Git:()=>ue,IGitExtension:()=>me,NotebookDiff:()=>Bt,PlainTextDiff:()=>le,default:()=>lr});var i=s(3730),r=s(6120),n=s(8661),o=s(6771),a=s(4083),l=s(8389),c=s(879),h=s(2626),d=s(2410),p=s(5331),g=s(5669),m=s(9850),u=s(1797),f=s(6510),_=s(6271),b=s.n(_),y=s(6168);class v{constructor(e){this._isDisposed=!1,this._challenger=e.challenger,this._filename=e.filename,this._reference=e.reference,this._changed=new y.Signal(this)}get changed(){return this._changed}get challenger(){return this._challenger}set challenger(e){const t=this._challenger.label!==e.label||this._challenger.source!==e.source||this._challenger.updateAt!==e.updateAt;this._challenger=e,t&&this._changed.emit({type:"challenger"})}get filename(){return this._filename}get reference(){return this._reference}set reference(e){const t=this._reference.label!==e.label||this._reference.source!==e.source||this._reference.updateAt!==e.updateAt;this._reference=e,t&&this._changed.emit({type:"reference"})}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,y.Signal.clearData(this))}}var w=s(2036),C=s(8681),k=s.n(C),x=s(3708);const E="CodeMirror-patchgutter";var S;!function(e){e[e.Equal=x.DIFF_EQUAL]="Equal",e[e.Delete=x.DIFF_DELETE]="Delete",e[e.Insert=x.DIFF_INSERT]="Insert"}(S||(S={}));const F=k().Pos,R="http://www.w3.org/2000/svg";class D{constructor(e,t){this.mv=e,this.type=t,this.classes="left"==t?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}init(e,t,s){this.edit=this.mv.edit,(this.edit.state.diffViews||(this.edit.state.diffViews=[])).push(this),this.orig=k()(e,Object.assign(Object.assign({},s),{value:t,readOnly:!this.mv.options.allowEditingOriginals})),"align"==this.mv.options.connect&&(this.edit.state.trackAlignable||(this.edit.state.trackAlignable=new oe(this.edit)),this.orig.state.trackAlignable=new oe(this.orig)),this.lockButton.title=this.edit.phrase("Toggle locked scrolling"),this.orig.state.diffViews=[this];let i=s.chunkClassLocation||"background";"[object Array]"!=Object.prototype.toString.call(i)&&(i=[i]),this.classes.classLocation=i,this.diff=X(K(t),K(s.value),this.mv.options.ignoreWhitespace),this.chunks=Y(this.diff),this.diffOutOfDate=this.dealigned=!1,this.needsScrollSync=null,this.showDifferences=!1!==s.showDifferences}registerEvents(e){this.forceUpdate=D.registerUpdate(this),D.setScrollLock(this,!0,!1),D.registerScroll(this,e)}setShowDifferences(e){(e=!1!==e)!=this.showDifferences&&(this.showDifferences=e,this.forceUpdate("full"))}static setScrollLock(e,t,s){e.lockScroll=t,t&&0!=s&&D.syncScroll(e,!0)&&O(e),(t?k().addClass:k().rmClass)(e.lockButton,"CodeMirror-merge-scrolllock-enabled")}static registerUpdate(e){const t={from:0,to:0,marked:[]},s={from:0,to:0,marked:[]};let i,r=!1;function n(i){D.updating=!0,r=!1,"full"==i&&(e.svg&&ne.clear(e.svg),e.copyButtons&&ne.clear(e.copyButtons),B(e.edit,t.marked,e.classes),B(e.orig,s.marked,e.classes),t.from=t.to=s.from=s.to=0),j(e),e.showDifferences&&(I(e.edit,e.diff,t,S.Insert,e.classes),I(e.orig,e.diff,s,S.Delete,e.classes)),"align"==e.mv.options.connect&&H(e),O(e),null!=e.needsScrollSync&&D.syncScroll(e,e.needsScrollSync),D.updating=!1}function o(t){D.updating||(e.dealigned=!0,a(t))}function a(e){D.updating||r||(clearTimeout(i),!0===e&&(r=!0),i=setTimeout(n,!0===e?20:250))}function l(i,r){e.diffOutOfDate||(e.diffOutOfDate=!0,t.from=t.to=s.from=s.to=0),o(r.text.length-1!=r.to.line-r.from.line)}function c(){e.diffOutOfDate=!0,e.dealigned=!0,n("full")}return e.edit.on("change",l),e.orig.on("change",l),e.edit.on("swapDoc",c),e.orig.on("swapDoc",c),"align"===e.mv.options.connect&&(k().on(e.edit.state.trackAlignable,"realign",o),k().on(e.orig.state.trackAlignable,"realign",o)),e.edit.on("viewportChange",(function(){a(!1)})),e.orig.on("viewportChange",(function(){a(!1)})),n(),n}static registerScroll(e,t){e.edit.on("scroll",(function(){D.syncScroll(e,!0)&&O(e)})),e.orig.on("scroll",(function(){D.syncScroll(e,!1)&&O(e),t&&D.syncScroll(t,!0)&&O(t)}))}static syncScroll(e,t){if(e.diffOutOfDate)return e.lockScroll&&null==e.needsScrollSync&&(e.needsScrollSync=t),!1;if(e.needsScrollSync=null,!e.lockScroll)return!0;let s,i;const r=+new Date;if(t?(s=e.edit,i=e.orig):(s=e.orig,i=e.edit),s.state.scrollSetBy==e&&(s.state.scrollSetAt||0)+250>r)return!1;const n=s.getScrollInfo();let o=0;if("align"==e.mv.options.connect)o=n.top;else{const r=.5*n.clientHeight,a=n.top+r,l=s.lineAtHeight(a,"local"),c=function(e,t,s){let i,r,n,o;for(let a=0;a<e.length;a++){const l=e[a],c=s?l.editFrom:l.origFrom,h=s?l.editTo:l.origTo;null==r&&(c>t?(r=l.editFrom,o=l.origFrom):h>t&&(r=l.editTo,o=l.origTo)),h<=t?(i=l.editTo,n=l.origTo):c<=t&&(i=l.editFrom,n=l.origFrom)}return{edit:{before:i,after:r},orig:{before:n,after:o}}}(e.chunks,l,t),h=D.getOffsets(s,t?c.edit:c.orig),d=D.getOffsets(i,t?c.orig:c.edit),p=(a-h.top)/(h.bot-h.top);let g,m;if(o=d.top-r+p*(d.bot-d.top),o>n.top)m=n.top/r,m<1&&(o=o*m+n.top*(1-m));else if(g=n.height-n.clientHeight-n.top,g<r){const e=i.getScrollInfo();e.height-e.clientHeight-o>g&&(m=g/r,m<1&&(o=o*m+(e.height-e.clientHeight-g)*(1-m)))}}return i.scrollTo(n.left,o),i.state.scrollSetAt=r,i.state.scrollSetBy=e,!0}static getOffsets(e,t){let s=t.after;return null==s&&(s=e.lastLine()+1),{top:e.heightAtLine(t.before||0,"local"),bot:e.heightAtLine(s,"local")}}}function j(e){e.diffOutOfDate&&(e.diff=X(e.orig.getValue(),e.edit.getValue(),e.mv.options.ignoreWhitespace),e.chunks=Y(e.diff),e.diffOutOfDate=!1,k().signal(e.edit,"updateDiff",e.diff))}function N(e,t,s){const i=s.classLocation;for(let r=0;r<i.length;r++)e.removeLineClass(t,i[r],s.chunk),e.removeLineClass(t,i[r],s.start),e.removeLineClass(t,i[r],s.end)}function B(e,t,s){for(let i=0;i<t.length;++i){const r=t[i];"clear"in r?r.clear():r.parent&&N(e,r,s)}t.length=0,e.clearGutter(E)}function I(e,t,s,i,r){const n=e.getViewport();e.operation((function(){s.from==s.to||n.from-s.to>20||s.from-n.to>20?(B(e,s.marked,r),P(e,t,i,s.marked,n.from,n.to,r),s.from=n.from,s.to=n.to):(n.from<s.from&&(P(e,t,i,s.marked,n.from,s.from,r),s.from=n.from),n.to>s.to&&(P(e,t,i,s.marked,s.to,n.to,r),s.to=n.to))}))}function T(e,t,s,i,r,n){const o=s.classLocation,a=e.getLineHandle(t);for(let t=0;t<o.length;t++)i&&e.addLineClass(a,o[t],s.chunk),r&&e.addLineClass(a,o[t],s.start),n&&e.addLineClass(a,o[t],s.end);return a}function M(e){const t=document.createElement("div");return t.className=e?"CodeMirror-patchgutter-delete":"CodeMirror-patchgutter-insert",t}function P(e,t,s,i,r,n,o){let a=F(0,0);const l=F(r,0),c=e.clipPos(F(n-1)),h=s==S.Delete?o.del:o.insert;function d(t,a){const l=Math.max(r,t),c=Math.min(n,a);for(let r=l;r<c;++r)i.push(T(e,r,o,!0,r==t,r==a-1)),e.setGutterMarker(r,E,M(s==S.Delete));t==a&&l==a&&c==a&&(l?i.push(T(e,l-1,o,!1,!1,!0)):i.push(T(e,l,o,!1,!0,!1)))}let p=0,g=!1;for(let r=0;r<t.length;++r){const n=t[r],o=n[0],m=n[1];if(o==S.Equal){const e=a.line+(Q(t,r)?0:1);ie(a,m);const s=a.line+(J(t,r)?1:0);s>e&&(g&&(d(p,e),g=!1),p=s)}else if(g=!0,o==s){const t=ie(a,m,!0),s=ne.posMax(l,a),r=ne.posMin(c,t);ne.posEq(s,r)||i.push(e.markText(s,r,{className:h})),a=t}}g&&d(p,a.line+1)}function O(e){if(!e.showDifferences)return;let t=0;e.svg&&(ne.clear(e.svg),t=e.gap.offsetWidth,ne.attrs(e.svg,"width",t,"height",e.gap.offsetHeight)),e.copyButtons&&ne.clear(e.copyButtons);const s=e.edit.getViewport(),i=e.orig.getViewport(),r=e.mv.wrap.getBoundingClientRect().top,n=r-e.edit.getScrollerElement().getBoundingClientRect().top+e.edit.getScrollInfo().top,o=r-e.orig.getScrollerElement().getBoundingClientRect().top+e.orig.getScrollInfo().top;for(let r=0;r<e.chunks.length;r++){const a=e.chunks[r];a.editFrom<=s.to&&a.editTo>=s.from&&a.origFrom<=i.to&&a.origTo>=i.from&&W(e,a,o,n,t)}}function L(e,t){let s=0,i=0;for(let r=0;r<t.length;r++){const n=t[r];if(n.editTo>e&&n.editFrom<=e)return null;if(n.editFrom>e)break;s=n.editTo,i=n.origTo}return i+(e-s)}function A(e,t,s){const i=e.state.trackAlignable;let r=e.firstLine(),n=0;const o=[];for(let e=0;;e++){const a=t[e],l=a?s?a.origFrom:a.editFrom:1e9;for(;n<i.alignable.length;n+=2){const e=i.alignable[n]+1;if(!(e<=r)){if(!(e<=l))break;o.push(e)}}if(!a)break;o.push(r=s?a.origTo:a.editTo)}return o}function z(e,t,s,i){let r=0,n=0,o=0,a=0;e:for(;;r++){const l=e[r],c=t[n];if(!l&&null==c)break;const h=l?l[0]:1e9,d=null==c?1e9:c;for(;o<s.length;){const e=s[o];if(e.origFrom<=d&&e.origTo>d){n++,r--;continue e}if(e.editTo>h){if(e.editFrom<=h)continue e;break}a+=e.origTo-e.origFrom-(e.editTo-e.editFrom),o++}if(h==d-a)l[i]=d,n++;else if(h<d-a)l[i]=h+a;else{const t=[d-a,null,null];t[i]=d,e.splice(r,0,t),n++}}}function H(e,t){if(!e.dealigned&&!t)return;if(!e.orig.curOp)return e.orig.operation((function(){H(e,t)}));e.dealigned=!1;const s=e.mv.left==e?e.mv.right:e.mv.left;s&&(j(s),s.dealigned=!1);const i=function(e,t){const s=A(e.edit,e.chunks,!1),i=[];if(t)for(let e=0,i=0;e<t.chunks.length;e++){const r=t.chunks[e].editTo;for(;i<s.length&&s[i]<r;)i++;i!=s.length&&s[i]==r||s.splice(i++,0,r)}for(let e=0;e<s.length;e++)i.push([s[e],null,null]);return z(i,A(e.orig,e.chunks,!0),e.chunks,1),t&&z(i,A(t.orig,t.chunks,!0),t.chunks,2),i}(e,s),r=e.mv.aligners;for(let e=0;e<r.length;e++)r[e].clear();r.length=0;const n=[e.edit,e.orig],o=[];s&&n.push(s.orig);for(let e=0;e<n.length;e++)o.push(n[e].getScrollInfo().top);for(let e=0;e<i.length;e++)U(n,i[e],r);for(let e=0;e<n.length;e++)n[e].scrollTo(null,o[e])}function U(e,t,s){let i=0;const r=[];for(let s=0;s<e.length;s++)if(null!=t[s]){const n=e[s].heightAtLine(t[s],"local");r[s]=n,i=Math.max(i,n)}for(let n=0;n<e.length;n++)if(null!=t[n]){const o=i-r[n];o>1&&s.push(G(e[n],t[n],o))}}function G(e,t,s){let i=!0;t>e.lastLine()&&(t--,i=!1);const r=document.createElement("div");return r.className="CodeMirror-merge-spacer",r.style.height=s+"px",r.style.minWidth="1px",e.addLineWidget(t,r,{height:s,above:i,mergeSpacer:!0,handleMouseEvents:!0})}function W(e,t,s,i,r){const n="left"==e.type,o=e.orig.heightAtLine(t.origFrom,"local",!0)-s;if(e.svg){let a=o,l=e.edit.heightAtLine(t.editFrom,"local",!0)-i;if(n){const e=a;a=l,l=e}let c=e.orig.heightAtLine(t.origTo,"local",!0)-s,h=e.edit.heightAtLine(t.editTo,"local",!0)-i;if(n){const e=c;c=h,h=e}const d=" C "+r/2+" "+l+" "+r/2+" "+a+" "+(r+2)+" "+a,p=" C "+r/2+" "+c+" "+r/2+" "+h+" -1 "+h;ne.attrs(e.svg.appendChild(document.createElementNS(R,"path")),"d","M -1 "+l+d+" L "+(r+2)+" "+c+p+" z","class",e.classes.connect)}if(e.copyButtons){const s=e.copyButtons.appendChild(ne.elt("div","left"===e.type?"⇝":"⇜","CodeMirror-merge-copy")),r=e.mv.options.allowEditingOriginals;if(s.title=e.edit.phrase(r?"Push to left":"Revert chunk"),s.chunk=t,s.style.top=(t.origTo>t.origFrom?o:e.edit.heightAtLine(t.editFrom,"local")-i)+"px",r){const s=e.edit.heightAtLine(t.editFrom,"local")-i,r=e.copyButtons.appendChild(ne.elt("div","right"==e.type?"⇝":"⇜","CodeMirror-merge-copy-reverse"));r.title="Push to right",r.chunk={editFrom:t.origFrom,editTo:t.origTo,origFrom:t.editFrom,origTo:t.editTo},r.style.top=s+"px","right"==e.type?r.style.left="2px":r.style.right="2px"}}}function V(e,t,s,i){if(e.diffOutOfDate)return;const r=i.origTo>s.lastLine()?F(i.origFrom-1):F(i.origFrom,0),n=F(i.origTo,0),o=i.editTo>t.lastLine()?F(i.editFrom-1):F(i.editFrom,0),a=F(i.editTo,0),l=e.mv.options.revertChunk;l?l(e.mv,s,r,n,t,o,a):t.replaceRange(s.getRange(r,n),o,a)}D.updating=!1;class ${constructor(e,t){this.options=t;const s=null==t.origLeft?t.orig:t.origLeft,i=t.origRight,r=null!=s,n=null!=i,o=1+(r?1:0)+(n?1:0),a=[];let l=this.left=null,c=this.right=null;const h=this;let d=null;r&&(l=this.left=new D(this,"left"),d=ne.elt("div",null,"CodeMirror-merge-pane CodeMirror-merge-left"),a.push(d),a.push(Z(l)));const p=ne.elt("div",null,"CodeMirror-merge-pane CodeMirror-merge-editor");a.push(p);let g=null;n&&(c=this.right=new D(this,"right"),a.push(Z(c)),g=ne.elt("div",null,"CodeMirror-merge-pane CodeMirror-merge-right"),a.push(g)),(n?g:p).className+=" CodeMirror-merge-pane-rightmost",a.push(ne.elt("div",null,null,"height: 0; clear: both;"));const m=this.wrap=e.appendChild(ne.elt("div",a,"CodeMirror-merge CodeMirror-merge-"+o+"pane"));if(this.edit=k()(p,Object.assign({},t)),this.edit.getOption("gutters").indexOf(E)<0){const e=[];this.edit.getOption("lineNumbers")&&e.push("CodeMirror-linenumbers"),e.push(E),this.edit.setOption("gutters",e),t.gutters=e}l&&l.init(d,s,t),c&&c.init(g,i,t),t.collapseIdentical&&this.editor().operation((function(){!function(e,t){"number"!=typeof t&&(t=2);const s=[],i=e.editor(),r=i.firstLine();for(let e=r,t=i.lastLine();e<=t;e++)s.push(!0);e.left&&se(e.left,t,r,s),e.right&&se(e.right,t,r,s);for(let n=0;n<s.length;n++)if(s[n]){const o=n+r;let a=0;for(a=1;n<s.length-1&&s[n+1];n++,a++);if(a>t){const t=[{line:o,cm:i}];e.left&&t.push({line:L(o,e.left.chunks),cm:e.left.orig}),e.right&&t.push({line:L(o,e.right.chunks),cm:e.right.orig});const s=te(a,t);e.options.onCollapse&&e.options.onCollapse(e,o,a,s)}}}(h,t.collapseIdentical)})),"align"==t.connect&&(this.aligners=[],H(this.left||this.right,!0)),l&&l.registerEvents(c),c&&c.registerEvents(l);const u=function(){l&&O(l),c&&O(c)};k().on(window,"resize",u);const f=setInterval((function(){let e=null;for(e=m.parentNode;e&&e!==document.body;e=e.parentNode);e||(clearInterval(f),k().off(window,"resize",u))}),5e3)}editor(){return this.edit}rightOriginal(){return this.right&&this.right.orig}leftOriginal(){return this.left&&this.left.orig}setShowDifferences(e){this.right&&this.right.setShowDifferences(e),this.left&&this.left.setShowDifferences(e)}rightChunks(){if(this.right)return j(this.right),this.right.chunks}leftChunks(){if(this.left)return j(this.left),this.left.chunks}}function Z(e){const t=e.lockButton=ne.elt("div",null,"CodeMirror-merge-scrolllock"),s=ne.elt("div",[t],"CodeMirror-merge-scrolllock-wrap");k().on(t,"click",(function(){D.setScrollLock(e,!e.lockScroll)}));const i=[s];if(!1!==e.mv.options.revertButtons&&(e.copyButtons=ne.elt("div",null,"CodeMirror-merge-copybuttons-"+e.type),k().on(e.copyButtons,"click",(function(t){const s=t.target||t.srcElement;s.chunk&&("CodeMirror-merge-copy-reverse"!=s.className?V(e,e.edit,e.orig,s.chunk):V(e,e.orig,e.edit,s.chunk))})),i.unshift(e.copyButtons)),"align"!=e.mv.options.connect){let t=document.createElementNS&&document.createElementNS(R,"svg");t&&!t.createSVGRect&&(t=null),e.svg=t,t&&i.push(t)}return e.gap=ne.elt("div",i,"CodeMirror-merge-gap")}function K(e){return"string"==typeof e?e:e.getValue()}let q;function X(e,t,s){q||(q=new x.diff_match_patch);const i=q.diff_main(e,t);q.diff_cleanupSemantic(i);for(let e=0;e<i.length;++e){const t=i[e];(s?/[^ \t]/.test(t[1]):t[1])?e&&i[e-1][0]==t[0]&&(i.splice(e--,1),i[e][1]+=t[1]):i.splice(e--,1)}return i}function Y(e){const t=[];if(!e.length)return t;let s=0,i=0;const r=F(0,0),n=F(0,0);for(let o=0;o<e.length;++o){const a=e[o],l=a[0];if(l==S.Equal){const l=!Q(e,o)||r.line<s||n.line<i?1:0,c=r.line+l,h=n.line+l;ie(r,a[1],null,n);const d=J(e,o)?1:0,p=r.line+d,g=n.line+d;p>c&&(o&&t.push({origFrom:i,origTo:h,editFrom:s,editTo:c}),s=p,i=g)}else ie(l==S.Insert?r:n,a[1])}return(s<=r.line||i<=n.line)&&t.push({origFrom:i,origTo:n.line+1,editFrom:s,editTo:r.line+1}),t}function J(e,t){if(t===e.length-1)return!0;let s=e[t+1][1];return!(1===s.length&&t<e.length-2||10!==s.charCodeAt(0)||t!==e.length-2&&(s=e[t+2][1],!(s.length>1||t==e.length-3)||10!==s.charCodeAt(0)))}function Q(e,t){if(0===t)return!0;let s=e[t-1][1];return 10==s.charCodeAt(s.length-1)&&(1==t||(s=e[t-2][1],10==s.charCodeAt(s.length-1)))}function ee(e,t,s){e.addLineClass(t,"wrap","CodeMirror-merge-collapsed-line");const i=document.createElement("span");i.className="CodeMirror-merge-collapsed-widget",i.title=e.phrase("Identical text collapsed. Click to expand.");const r=e.markText(F(t,0),F(s-1),{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:i,clearOnEnter:!0});function n(){r.clear(),e.removeLineClass(t,"wrap","CodeMirror-merge-collapsed-line")}return r.explicitlyCleared&&n(),k().on(i,"click",n),r.on("clear",n),k().on(i,"click",n),{mark:r,clear:n}}function te(e,t){const s=[];function i(){for(let e=0;e<s.length;e++)s[e].clear()}for(let r=0;r<t.length;r++){const n=t[r],o=ee(n.cm,n.line,n.line+e);s.push(o),o.mark.on("clear",i)}return s[0].mark}function se(e,t,s,i){for(let r=0;r<e.chunks.length;r++){const n=e.chunks[r];for(let e=n.editFrom-t;e<n.editTo+t;e++){const t=e+s;t>=0&&t<i.length&&(i[t]=!1)}}}function ie(e,t,s,i){const r=s?F(e.line,e.ch):e;let n=0;for(;;){const e=t.indexOf("\n",n);if(-1==e)break;++r.line,i&&++i.line,n=e+1}return r.ch=(n?0:r.ch)+(t.length-n),i&&(i.ch=(n?0:i.ch)+(t.length-n)),r}var re,ne;!function(e){e[e.F_WIDGET=1]="F_WIDGET",e[e.F_WIDGET_BELOW=2]="F_WIDGET_BELOW",e[e.F_MARKER=4]="F_MARKER"}(re||(re={}));class oe{constructor(e){this.cm=e,this.alignable=[],this.height=e.doc.height;const t=this;e.on("markerAdded",(function(e,s){if(!s.collapsed)return;const i=s.find(1);null!=i&&t.set(i.line,re.F_MARKER)})),e.on("markerCleared",(function(e,s,i,r){null!==r&&s.collapsed&&t.check(r,re.F_MARKER,t.hasMarker)})),e.on("markerChanged",this.signal.bind(this)),e.on("lineWidgetAdded",(function(e,s,i){s.mergeSpacer||(s.above?t.set(i-1,re.F_WIDGET_BELOW):t.set(i,re.F_WIDGET))})),e.on("lineWidgetCleared",(function(e,s,i){s.mergeSpacer||(s.above?t.check(i-1,re.F_WIDGET_BELOW,t.hasWidgetBelow):t.check(i,re.F_WIDGET,t.hasWidget))})),e.on("lineWidgetChanged",this.signal.bind(this)),e.on("change",(function(e,s){const i=s.from.line,r=s.to.line-s.from.line,n=s.text.length-1,o=i+n;(r||n)&&t.map(i,r,n),t.check(o,re.F_MARKER,t.hasMarker),(r||n)&&t.check(s.from.line,re.F_MARKER,t.hasMarker)})),e.on("viewportChange",(function(){t.cm.doc.height!==t.height&&t.signal()}))}signal(){k().signal(this,"realign"),this.height=this.cm.doc.height}set(e,t){let s=-1;for(;s<this.alignable.length;s+=2){const i=this.alignable[s]-e;if(0==i){if((this.alignable[s+1]&t)==t)return;return this.alignable[s+1]|=t,void this.signal()}if(i>0)break}this.signal(),this.alignable.splice(s,0,e,t)}find(e){for(let t=0;t<this.alignable.length;t+=2)if(this.alignable[t]==e)return t;return-1}check(e,t,s){const i=this.find(e);if(-1!=i&&this.alignable[i+1]&t&&!s.call(this,e)){this.signal();const e=this.alignable[i+1]&~t;e?this.alignable[i+1]=e:this.alignable.splice(i,2)}}hasMarker(e){const t=this.cm.getLineHandle(e);if(t.markedSpans)for(let e=0;e<t.markedSpans.length;e++)if(t.markedSpans[e].marker.collapsed&&null!==t.markedSpans[e].to)return!0;return!1}hasWidget(e){const t=this.cm.getLineHandle(e);if(t.widgets)for(let e=0;e<t.widgets.length;e++)if(!t.widgets[e].above&&!t.widgets[e].mergeSpacer)return!0;return!1}hasWidgetBelow(e){if(e==this.cm.lastLine())return!1;const t=this.cm.getLineHandle(e+1);if(t.widgets)for(let e=0;e<t.widgets.length;e++)if(t.widgets[e].above&&!t.widgets[e].mergeSpacer)return!0;return!1}map(e,t,s){const i=s-t,r=e+t;let n=-1,o=-1;for(let t=0;t<this.alignable.length;t+=2){const s=this.alignable[t];s==e&&this.alignable[t+1]&re.F_WIDGET_BELOW&&(n=t),s==r&&this.alignable[t+1]&re.F_WIDGET_BELOW&&(o=t),s<=e||(s<r?this.alignable.splice(t--,2):this.alignable[t]+=i)}if(n>-1){const e=this.alignable[n+1];e==re.F_WIDGET_BELOW?this.alignable.splice(n,2):this.alignable[n+1]=e&~re.F_WIDGET_BELOW}o>-1&&s&&this.set(e+s,re.F_WIDGET_BELOW)}}k().commands.goNextDiff=function(e){return ne.goNearbyDiff(e,1)},k().commands.goPrevDiff=function(e){return ne.goNearbyDiff(e,-1)},function(e){function t(e,t,s){for(let i=e.length-1;i>=0;i--){const r=e[i],n=(s?r.origTo:r.editTo)-1;if(n<t)return n}}function s(e,t,s){for(let i=0;i<e.length;i++){const r=e[i],n=s?r.origFrom:r.editFrom;if(n>t)return n}}e.elt=function(e,t,s,i){const r=document.createElement(e);if(s&&(r.className=s),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(let e=0;e<t.length;++e)r.appendChild(t[e]);return r},e.clear=function(e){for(let t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild)},e.attrs=function(e,...t){for(let s=1;s<t.length;s+=2)e.setAttribute(t[s],t[s+1])},e.posMin=function(e,t){return(e.line-t.line||e.ch-t.ch)<0?e:t},e.posMax=function(e,t){return(e.line-t.line||e.ch-t.ch)>0?e:t},e.posEq=function(e,t){return e.line==t.line&&e.ch==t.ch},e.goNearbyDiff=function(e,i){let r=null;const n=e.state.diffViews,o=e.getCursor().line;if(n)for(let a=0;a<n.length;a++){const l=n[a],c=e==l.orig;j(l);const h=i<0?t(l.chunks,o,c):s(l.chunks,o,c);null==h||null!=r&&!(i<0?h>r:h<r)||(r=h)}if(null==r)return k().Pass;e.setCursor(r,0)}}(ne||(ne={}));const ae=async(e,t)=>{const s=new le(e);return await s.ready,s};class le extends f.Widget{constructor(e){super({node:le.createNode(e.reference.label,e.challenger.label)}),this._reference=null,this._challenger=null;const t=new u.PromiseDelegate;this._isReady=t.promise,this._container=this.node.lastElementChild,this._model=e,Promise.all([this._model.reference.content(),this._model.challenger.content()]).then((([e,s])=>{this._reference=e,this._challenger=s,t.resolve()})).catch((e=>{this.showError(e),t.resolve()}))}get ready(){return this._isReady}onAfterAttach(){this.ready.then((()=>{null!==this._challenger&&null!==this._reference&&this.createDiffView(this._challenger,this._reference)})).catch((e=>{this.showError(e)}))}onBeforeDetach(){this._container.innerHTML=""}async refresh(){await this.ready;try{this._container.innerHTML="",this._mergeView=null,null!==this._reference&&(this._reference=await this._model.reference.content()),null!==this._challenger&&(this._challenger=await this._model.challenger.content()),this.createDiffView(this._challenger,this._reference),this._challenger=null,this._reference=null}catch(e){this.showError(e)}}static createNode(e,t){const s=document.createElement("div");return s.className="jp-git-diff-root",s.innerHTML=`\n    <div class="jp-git-diff-banner">\n      <span>${e}</span>\n      <span class="jp-spacer"></span>\n      <span>${t}</span>\n    </div>\n    <div class="jp-git-PlainText-diff"></div>`,s}async createDiffView(e,t){if(!this._mergeView){const r=w.Mode.findByFileName(this._model.filename)||w.Mode.findBest(this._model.filename);this._mergeView=(s=this._container,i=Object.assign({value:e,orig:t,mode:r.mime},this.getDefaultOptions()),new $(s,i))}var s,i;return Promise.resolve()}showError(e){var t;console.error("Failed to load file diff.",e,null===(t=e)||void 0===t?void 0:t.traceback);const s=(e.message||e).replace("\n","<br />");this.node.innerHTML=`<p class="jp-git-diff-error">\n      <span>Error Loading File Diff:</span>\n      <span class="jp-git-diff-error-message">${s}</span>\n    </p>`}getDefaultOptions(){return{lineNumbers:!0,theme:"jupyter",connect:"align",collapseIdentical:!0,readOnly:!0,revertButtons:!1}}}var ce=s(8196),he=s.n(ce),de=s(9241),pe=s(6078),ge=s(5066);const me=new u.Token("jupyter.extensions.git_plugin");var ue,fe,_e,be;!function(e){let t;!function(e){let t;!function(e){e[e.WORKING=0]="WORKING",e[e.INDEX=1]="INDEX"}(t=e.SpecialRef||(e.SpecialRef={}))}(t=e.Diff||(e.Diff={}));class s extends ge.ServerConnection.ResponseError{constructor(e,t=`Invalid response: ${e.status} ${e.statusText}`,s="",i={}){super(e,t),this.traceback=s,this._json=i}get json(){return this._json}}e.GitResponseError=s;class i extends Error{constructor(){super("Not in a Git Repository")}}e.NotInRepository=i}(ue||(ue={})),function(e){e[e.SUCCESS=10]="SUCCESS",e[e.INFO=20]="INFO",e[e.RUNNING=30]="RUNNING",e[e.WARNING=40]="WARNING",e[e.ERROR=50]="ERROR"}(fe||(fe={})),function(e){e.gitFileAdd="git:context-add",e.gitFileDiff="git:context-diff",e.gitFileDiscard="git:context-discard",e.gitFileDelete="git:context-delete",e.gitFileOpen="git:context-open",e.gitFileUnstage="git:context-unstage",e.gitFileStage="git:context-stage",e.gitFileTrack="git:context-track",e.gitIgnore="git:context-ignore",e.gitIgnoreExtension="git:context-ignoreExtension",e.gitNoAction="git:no-action"}(_e||(_e={})),function(e){e.gitUI="git:ui",e.gitTerminalCommand="git:terminal-command",e.gitInit="git:init",e.gitOpenUrl="git:open-url",e.gitToggleSimpleStaging="git:toggle-simple-staging",e.gitToggleDoubleClickDiff="git:toggle-double-click-diff",e.gitAddRemote="git:add-remote",e.gitClone="git:clone",e.gitOpenGitignore="git:open-gitignore",e.gitPush="git:push",e.gitPull="git:pull",e.gitSubmitCommand="git:submit-commit",e.gitShowDiff="git:show-diff"}(be||(be={}));const ye=["Invalid username or password","could not read Username","could not read Password"];async function ve(e="",t="GET",s=null,i="git"){const r=ge.ServerConnection.makeSettings(),n=p.URLExt.join(r.baseUrl,i,e),o={method:t,body:s?JSON.stringify(s):void 0};let a;try{a=await ge.ServerConnection.makeRequest(n,o,r)}catch(e){throw new ge.ServerConnection.NetworkError(e)}let l=await a.text(),c=!1;if(l.length>0)try{l=JSON.parse(l),c=!0}catch(e){console.log("Not a JSON response body.",a)}if(!a.ok){if(c){const{message:e,traceback:t}=l,s=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]])}return s}(l,["message","traceback"]);throw new ue.GitResponseError(a,e||`Invalid response: ${a.status} ${a.statusText}`,t||"",s)}throw new ue.GitResponseError(a,l)}return l}var we=s(8908);class Ce{constructor(e){this._isDisposed=!1,this._taskList=new we.LinkedList,this._taskChanged=new y.Signal(e)}get isDisposed(){return this._isDisposed}get taskChanged(){return this._taskChanged}add(e){const t=this._generateTaskID();return this._taskList.addLast({id:t,task:e}),1===this._taskList.length&&this._taskChanged.emit(e),t}dispose(){this.isDisposed||(this._isDisposed=!0,y.Signal.clearData(this))}async execute(e,t){const s=this.add(e);try{return await t()}finally{this.remove(s)}}remove(e){let t=this._taskList.firstNode;if((null==t?void 0:t.value.id)===e)this._taskList.removeNode(t);else for(;t.next;)if(t=t.next,t.value&&t.value.id===e){this._taskList.removeNode(t);break}0===this._taskList.length?this._taskChanged.emit("empty"):this._taskChanged.emit(this._taskList.first.task)}_generateTaskID(){return u.UUID.uuid4()}}const ke={};function xe(e){var t,s;return null===(s=ke[null===(t=p.PathExt.extname(e))||void 0===t?void 0:t.toLocaleLowerCase()])||void 0===s?void 0:s.callback}class Ee{constructor(e,t=null,s=null,i){let r;this._fetchRemotes=async()=>{try{const e=await this._getPathRepository();await ve("remote/fetch","POST",{current_path:e})}catch(e){console.error("Failed to fetch remotes",e)}},this._refreshModel=async()=>{await this._taskHandler.execute("git:refresh",(async()=>{try{await this.refreshBranch(),await this.refreshStatus()}catch(e){console.error("Failed to refresh git status",e)}}))},this._refreshStandby=()=>!(null!==this.pathRepository&&!this._standbyCondition())||"when-hidden",this._pathRepository=null,this._branches=[],this._currentBranch=null,this._isDisposed=!1,this._markerCache=new Fe((()=>this._markChanged.emit())),this.__currentMarker=null,this._readyPromise=Promise.resolve(),this._pendingReadyPromise=0,this._standbyCondition=()=>!1,this._headChanged=new y.Signal(this),this._markChanged=new y.Signal(this),this._repositoryChanged=new y.Signal(this),this._statusChanged=new y.Signal(this),this._serverRoot=e,this._docmanager=t,this._docRegistry=s,this._settings=i||null,this._taskHandler=new Ce(this),this._clearStatus(),i?(r=i.composite.refreshInterval,i.changed.connect(this._onSettingsChange,this)):r=3e3,this._statusPoll=new pe.Poll({factory:this._refreshModel,frequency:{interval:r,backoff:!0,max:3e5},standby:this._refreshStandby}),this._fetchPoll=new pe.Poll({auto:!1,factory:this._fetchRemotes,frequency:{interval:r,backoff:!0,max:3e5},standby:this._refreshStandby})}get branches(){return this._branches}get currentBranch(){return this._currentBranch}get isDisposed(){return this._isDisposed}get isReady(){return 0===this._pendingReadyPromise}get ready(){return this._readyPromise}get pathRepository(){return this._pathRepository}set pathRepository(e){const t={name:"pathRepository",newValue:null,oldValue:this._pathRepository};if(null===e)this._pendingReadyPromise+=1,this._readyPromise.then((()=>{this._pathRepository=null,this._pendingReadyPromise-=1,t.newValue!==t.oldValue&&this.refresh().then((()=>this._repositoryChanged.emit(t)))}));else{const s=this._readyPromise;this._pendingReadyPromise+=1,this._readyPromise=Promise.all([s,this.showTopLevel(e)]).then((([e,s])=>{t.newValue=this._pathRepository=s,t.newValue!==t.oldValue&&this.refresh().then((()=>this._repositoryChanged.emit(t))),this._pendingReadyPromise-=1})).catch((t=>{this._pendingReadyPromise-=1,console.error(`Fail to find Git top level for path ${e}.\n${t}`)}))}}get refreshStandbyCondition(){return this._standbyCondition}set refreshStandbyCondition(e){this._standbyCondition=e}get status(){return this._status}get headChanged(){return this._headChanged}get markChanged(){return this._markChanged}get repositoryChanged(){return this._repositoryChanged}get statusChanged(){return this._statusChanged}get taskChanged(){return this._taskHandler.taskChanged}get _currentMarker(){return this.__currentMarker||this._setMarker(this.pathRepository,this._currentBranch?this._currentBranch.name:""),this.__currentMarker}async add(...e){const t=await this._getPathRepository();await this._taskHandler.execute("git:add:files",(async()=>{await ve("add","POST",{add_all:!e,filename:e||"",top_repo_path:t})})),await this.refreshStatus()}getFile(e){return this._status.files.find((t=>this.getRelativeFilePath(t.to)===e))}async addAllUnstaged(){const e=await this._getPathRepository();await this._taskHandler.execute("git:add:files:all_unstaged",(async()=>{await ve("add_all_unstaged","POST",{top_repo_path:e})})),await this.refreshStatus()}async addAllUntracked(){const e=await this._getPathRepository();await this._taskHandler.execute("git:add:files:all_untracked",(async()=>{await ve("add_all_untracked","POST",{top_repo_path:e})})),await this.refreshStatus()}async addRemote(e,t){const s=await this._getPathRepository();await this._taskHandler.execute("git:add:remote",(async()=>{await ve("remote/add","POST",{top_repo_path:s,url:e,name:t})}))}async allHistory(e=25){const t=await this._getPathRepository();return await this._taskHandler.execute("git:fetch:history",(async()=>await ve("all_history","POST",{current_path:t,history_count:e})))}async checkout(e){const t={checkout_branch:!1,new_check:!1,branchname:"",startpoint:"",checkout_all:!0,filename:"",top_repo_path:await this._getPathRepository()};void 0!==e&&(e.branchname?(t.branchname=e.branchname,t.checkout_branch=!0,t.new_check=!0===e.newBranch,e.newBranch&&(t.startpoint=e.startpoint||this._currentBranch.name)):e.filename&&(t.filename=e.filename,t.checkout_all=!1));const s=await this._taskHandler.execute("git:checkout",(async()=>{var e;let s;t.new_check||(s=t.checkout_branch&&!t.new_check?await this._changedFiles(this._currentBranch.name,t.branchname):t.filename?{files:[t.filename]}:await this._changedFiles("WORKING","HEAD"));const i=await ve("checkout","POST",t);return null===(e=null==s?void 0:s.files)||void 0===e||e.forEach((e=>this._revertFile(e))),i}));return t.checkout_branch?await this.refreshBranch():await this.refreshStatus(),s}async clone(e,t,s){return await this._taskHandler.execute("git:clone",(async()=>await ve("clone","POST",{current_path:e,clone_url:t,auth:s})))}async commit(e){const t=await this._getPathRepository();await this._taskHandler.execute("git:commit:create",(async()=>{await ve("commit","POST",{commit_msg:e,top_repo_path:t})})),await this.refresh()}async config(e){const t=await this._getPathRepository();return await this._taskHandler.execute("git:config:"+(e?"set":"get"),(async()=>{if(!e)return await ve("config","POST",{path:t});await ve("config","POST",{path:t,options:e})}))}async deleteBranch(e){const t=await this._getPathRepository();await this._taskHandler.execute("git:branch:delete",(async()=>await ve("branch/delete","POST",{current_path:t,branch:e})))}async detailedLog(e){const t=await this._getPathRepository(),s=await this._taskHandler.execute("git:fetch:commit_log",(async()=>await ve("detailed_log","POST",{selected_hash:e,current_path:t})));return s.modified_files=s.modified_files.map((e=>(e.type=this._resolveFileType(e.modified_file_path),e))),s}dispose(){this.isDisposed||(this._isDisposed=!0,this._fetchPoll.dispose(),this._statusPoll.dispose(),this._taskHandler.dispose(),y.Signal.clearData(this))}async ensureGitignore(){const e=await this._getPathRepository();await ve("ignore","POST",{top_repo_path:e}),this._openGitignore(),await this.refreshStatus()}getRelativeFilePath(e){return null===this.pathRepository||void 0===this._serverRoot?null:p.PathExt.join(p.PathExt.relative(this._serverRoot,this.pathRepository),e||"")}async ignore(e,t){const s=await this._getPathRepository();await ve("ignore","POST",{top_repo_path:s,file_path:e,use_extension:t}),this._openGitignore(),await this.refreshStatus()}async init(e){await this._taskHandler.execute("git:init",(async()=>{await ve("init","POST",{current_path:e})}))}async log(e=25){const t=await this._getPathRepository();return await this._taskHandler.execute("git:fetch:log",(async()=>await ve("log","POST",{current_path:t,history_count:e})))}async pull(e){const t=await this._getPathRepository(),s=this._taskHandler.execute("git:pull",(async()=>{var s;return await ve("pull","POST",{current_path:t,auth:e,cancel_on_conflict:(null===(s=this._settings)||void 0===s?void 0:s.composite.cancelPullMergeConflict)||!1})}));return this.refreshBranch(),s}async push(e){const t=await this._getPathRepository(),s=this._taskHandler.execute("git:push",(async()=>await ve("push","POST",{current_path:t,auth:e})));return this.refreshBranch(),s}async refresh(){await this._statusPoll.refresh(),await this._statusPoll.tick}async refreshBranch(){try{const e=await this._taskHandler.execute("git:refresh:branches",(async()=>await this._branch()));let t=!1;t=this._currentBranch&&e?this._currentBranch.name!==e.current_branch.name||this._currentBranch.top_commit!==e.current_branch.top_commit:this._currentBranch!==e.current_branch,this._branches=e.branches,this._currentBranch=e.current_branch,this._currentBranch&&this._setMarker(this.pathRepository,this._currentBranch.name),t&&this._headChanged.emit(),this._branches.some((e=>e.is_remote_branch))?this._fetchPoll.start():this._fetchPoll.stop()}catch(e){const t=null!==this._currentBranch;if(this._branches=[],this._currentBranch=null,this._fetchPoll.stop(),t&&this._headChanged.emit(),!(e instanceof ue.NotInRepository))throw e}}async refreshStatus(){var e;let t;try{t=await this._getPathRepository()}catch(e){if(this._clearStatus(),!(e instanceof ue.NotInRepository))throw e;return}try{const s=await this._taskHandler.execute("git:refresh:status",(async()=>await ve("status","POST",{current_path:t})));this._setStatus({branch:s.branch||null,remote:s.remote||null,ahead:s.ahead||0,behind:s.behind||0,files:null===(e=s.files)||void 0===e?void 0:e.map((e=>{return Object.assign(Object.assign({},e),{status:(t=e.x,s=e.y,"?"===t&&"?"===s?"untracked":" "!==t?" "!==s?"partially-staged":"staged":" "!==s?"unstaged":null),type:this._resolveFileType(e.to)});var t,s}))})}catch(e){return this._clearStatus(),void console.error(e)}}async reset(e){const t=await this._getPathRepository();await this._taskHandler.execute("git:reset:changes",(async()=>{let s;s=void 0===e?(await this._changedFiles("INDEX","HEAD")).files:[e],await ve("reset","POST",{reset_all:void 0===e,filename:void 0===e?null:e,top_repo_path:t}),s.forEach((e=>{this._revertFile(e)}))})),await this.refreshStatus()}async resetToCommit(e=""){const t=await this._getPathRepository();await this._taskHandler.execute("git:reset:hard",(async()=>{const s=(await this._changedFiles(null,null,e)).files;await ve("reset_to_commit","POST",{commit_id:e,top_repo_path:t}),null==s||s.forEach((e=>{this._revertFile(e)}))})),await this.refreshBranch()}async showPrefix(e){try{return(await this._taskHandler.execute("git:fetch:prefix_path",(async()=>await ve("show_prefix","POST",{current_path:e})))).under_repo_path||null}catch(e){if(e instanceof ue.GitResponseError&&500===e.response.status&&128===e.json.code)return null;throw e}}async showTopLevel(e){try{return(await this._taskHandler.execute("git:fetch:top_level_path",(async()=>await ve("show_top_level","POST",{current_path:e})))).top_repo_path||null}catch(e){if(e instanceof ue.GitResponseError&&500===e.response.status&&128===e.json.code)return null;throw e}}async tags(){const e=await this._getPathRepository();return await this._taskHandler.execute("git:tag:list",(async()=>await ve("tags","POST",{current_path:e})))}async checkoutTag(e){const t=await this._getPathRepository();return await this._taskHandler.execute("git:tag:checkout",(async()=>await ve("tag_checkout","POST",{current_path:t,tag_id:e})))}addMark(e,t){this._currentMarker.add(e,t)}getMark(e){return this._currentMarker.get(e)}toggleMark(e){this._currentMarker.toggle(e)}registerDiffProvider(e,t,s){t.forEach((t=>{ke[t.toLocaleLowerCase()]={name:e,callback:s}}))}async revertCommit(e,t){const s=await this._getPathRepository();await this._taskHandler.execute("git:commit:revert",(async()=>{const e=(await this._changedFiles(null,null,t+"^!")).files;await ve("delete_commit","POST",{commit_id:t,top_repo_path:s}),null==e||e.forEach((e=>{this._revertFile(e)}))})),await this.commit(e)}async _branch(){const e=await this._getPathRepository();return await this._taskHandler.execute("git:fetch:branches",(async()=>await ve("branch","POST",{current_path:e})))}async _changedFiles(e,t,s){return await ve("changed_files","POST",{current_path:this.pathRepository,base:e,remote:t,single_commit:s})}_clearStatus(){this._status={branch:null,remote:null,ahead:0,behind:0,files:[]}}async _getPathRepository(){await this.ready;const e=this.pathRepository;if(null===e)throw new ue.NotInRepository;return e}_resolveFileType(e){return e.endsWith("/")?de.DocumentRegistry.getDefaultDirectoryFileType():this._docRegistry.getFileTypesForPath(e)[0]||de.DocumentRegistry.getDefaultTextFileType()}_setStatus(e){let t=this._status.ahead===e.ahead&&this._status.behind===e.behind&&this._status.branch===e.branch&&this._status.files.length===e.files.length;if(t)for(const s of e.files)if(this._status.files.findIndex((e=>e.from===s.from&&e.to===s.to&&e.x===s.x&&e.y===s.y))){t=!1;break}t||(this._status=e,this._statusChanged.emit(this._status))}_onSettingsChange(e){this._fetchPoll.frequency=Object.assign(Object.assign({},this._fetchPoll.frequency),{interval:e.composite.refreshInterval}),this._statusPoll.frequency=Object.assign(Object.assign({},this._statusPoll.frequency),{interval:e.composite.refreshInterval})}_openGitignore(){if(this._docmanager){const e=this._docmanager.openOrReveal(this.getRelativeFilePath(".gitignore"));e&&!e.context.model.dirty&&e.context.revert()}}_revertFile(e){const t=this._docmanager.findWidget(this.getRelativeFilePath(e));t&&!t.context.model.dirty&&t.context.revert()}_setMarker(e,t){this.__currentMarker=this._markerCache.get(e,t)}}class Se{constructor(e){this._refresh=e,this._marks={}}add(e,t=!0){e in this._marks||this.set(e,t)}get(e){return this._marks[e]}set(e,t){this._marks[e]=t,this._refresh()}toggle(e){this.set(e,!this._marks[e])}}class Fe{constructor(e){this._refresh=e,this._branchMarkers={}}get(e,t){const s=Fe.markerKey(e,t);if(s in this._branchMarkers)return this._branchMarkers[s];const i=new Se(this._refresh);return this._branchMarkers[s]=i,i}static markerKey(e,t){return[e,t].join(":")}}var Re=s(1926);const De=(0,Re.style)({flex:"0 0 auto",background:"none",lineHeight:"0px",padding:"0px 4px",width:"16px",border:"none",outline:"none",cursor:"pointer",$nest:{"&:active":{transform:"scale(1.272019649)",overflow:"hidden"},"&:disabled":{cursor:"default"}}}),je=(0,Re.style)({display:"none"}),Ne=(()=>{const e={$nest:{}},t=`&:hover .${je}`;return e.$nest[t]={display:"block"},e})(),Be=(0,Re.style)({height:"inherit",minHeight:"150px",overflow:"hidden",overflowY:"auto"}),Ie=new g.LabIcon({name:"git",svgstr:'<svg\n  xmlns="http://www.w3.org/2000/svg"\n  viewBox="0 0 20 20"\n  width="16"\n>\n  <path\n    class="jp-icon3 jp-icon-selectable"\n    d="M19.6 9.1 10.9 0.4c-0.5-0.5-1.3-0.5-1.8 0l-1.8 1.8 2.3 2.3c0.5-0.2 1.1-0.1 1.6 0.4 0.4 0.4 0.5 1 0.4 1.6l2.2 2.2c0.5-0.2 1.2-0.1 1.6 0.4 0.6 0.6 0.6 1.6 0 2.2-0.6 0.6-1.6 0.6-2.2 0C12.7 10.7 12.6 10.1 12.8 9.5l-2.1-2.1v5.4c0.1 0.1 0.3 0.2 0.4 0.3 0.6 0.6 0.6 1.6 0 2.2-0.6 0.6-1.6 0.6-2.2 0-0.6-0.6-0.6-1.6 0-2.2 0.1-0.1 0.3-0.3 0.5-0.3V7.4C9.3 7.3 9.1 7.2 9 7 8.5 6.6 8.4 5.9 8.6 5.3L6.4 3.1 0.4 9.1c-0.5 0.5-0.5 1.3 0 1.8l8.7 8.7c0.5 0.5 1.3 0.5 1.8 0l8.7-8.7c0.5-0.5 0.5-1.3 0-1.8"\n    fill="#616161"\n  />\n</svg>\n'}),Te=new g.LabIcon({name:"git:add",svgstr:'<svg\n   xmlns="http://www.w3.org/2000/svg"\n   width="16"\n   viewBox="0 0 24 24"\n   version="1.1">\n  <g\n     class="jp-icon3 jp-icon-selectable"\n     fill="#4F4F4F">\n    <path\n       d="m 22,13 h -9 v 9 H 11 V 13 H 2 v -2 h 9 V 2 h 2 v 9 h 9 z"/>\n  </g>\n</svg>\n'}),Me=new g.LabIcon({name:"git:branch",svgstr:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 18 18">\n<path class="jp-icon3 jp-icon-selectable" d="M12.499,3.177 C11.205,3.177 10.166,4.216 10.166,5.51 C10.166,6.366 10.64,7.114 11.333,7.515 L11.333,7.843 C11.333,9.009 10.166,10.176 9,10.176 C8.034,10.176 7.269,10.376 6.667,10.704 L6.667,5.182 C7.36,4.781 7.834,4.034 7.834,3.177 C7.834,1.883 6.795,0.844 5.501,0.844 C4.207,0.844 3.168,1.883 3.168,3.177 C3.168,4.034 3.642,4.781 4.334,5.182 L4.334,12.818 C3.642,13.219 3.168,13.966 3.168,14.823 C3.168,16.117 4.207,17.156 5.501,17.156 C6.795,17.156 7.834,16.117 7.834,14.823 C7.834,14.203 7.597,13.656 7.214,13.237 C7.56,12.818 8.107,12.49 9,12.49 C11.333,12.49 13.666,10.157 13.666,7.824 L13.666,7.496 C14.358,7.095 14.832,6.348 14.832,5.492 C14.832,4.198 13.793,3.159 12.499,3.159 z M5.501,2.011 C6.139,2.011 6.667,2.539 6.667,3.177 C6.667,3.815 6.139,4.344 5.501,4.344 C4.863,4.344 4.334,3.815 4.334,3.177 C4.334,2.539 4.863,2.011 5.501,2.011 z M5.501,16.008 C4.863,16.008 4.334,15.479 4.334,14.841 C4.334,14.203 4.863,13.675 5.501,13.675 C6.139,13.675 6.667,14.203 6.667,14.841 C6.667,15.479 6.139,16.008 5.501,16.008 z M12.499,6.676 C11.861,6.676 11.333,6.148 11.333,5.51 C11.333,4.872 11.861,4.344 12.499,4.344 C13.137,4.344 13.666,4.872 13.666,5.51 C13.666,6.148 13.137,6.676 12.499,6.676 z" fill="#4F4F4F"/>\n</svg>\n'}),Pe=new g.LabIcon({name:"git:clone",svgstr:'<svg width="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g class="jp-icon3" fill="#616161">\n<path d="M18.3438 13.2365L10.7648 5.65849C10.3311 5.22492 9.61471 5.22492 9.18108 5.65849L7.61625 7.22311L9.61471 9.2213C10.086 9.07049 10.6139 9.16474 10.9721 9.54176C11.3492 9.91878 11.4435 10.4466 11.2927 10.9179L13.2157 12.8407C13.687 12.6898 14.2149 12.7841 14.592 13.1611C15.1199 13.6701 15.1199 14.5184 14.592 15.0462C14.0641 15.574 13.2345 15.574 12.7067 15.0462C12.3107 14.6503 12.2165 14.0848 12.4239 13.5947L10.6328 11.8039V16.5166C10.7648 16.5731 10.8779 16.6674 10.991 16.7616C11.5189 17.2894 11.5189 18.1189 10.991 18.6467C10.4631 19.1557 9.63356 19.1557 9.10567 18.6467C8.57777 18.1189 8.57777 17.2894 9.10567 16.7616C9.23764 16.6297 9.38847 16.5354 9.53929 16.4789V11.7096C9.38847 11.6531 9.23764 11.5399 9.10567 11.4268C8.70975 11.031 8.61548 10.4654 8.82287 9.97533L6.84326 8.01484L1.65859 13.1988C1.22497 13.6324 1.22497 14.3487 1.65859 14.7823L9.21879 22.3415C9.65241 22.775 10.3688 22.775 10.8025 22.3415L18.325 14.82C18.7774 14.3676 18.7774 13.6701 18.3438 13.2365Z"/>\n<rect x="14.6666" y="5.33331" width="6.66667" height="1.33333"/>\n<rect x="18.6666" y="2.66669" width="6.66667" height="1.33333" transform="rotate(90 18.6666 2.66669)"/>\n</g>\n</svg>\n'}),Oe=new g.LabIcon({name:"git:deletions",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path class="jp-icon3" fill="white" d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n'}),Le=new g.LabIcon({name:"git:desktop",svgstr:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 24 24">\n  <path class="jp-icon3" d="M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7l-2 3v1h8v-1l-2-3h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 12H3V4h18v10z" fill="#4F4F4F">\n  </path>\n</svg>'}),Ae=new g.LabIcon({name:"git:diff",svgstr:'<svg width="16" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <g class="jp-icon3 jp-icon-selectable" fill="#4F4F4F">\n    <path d="M9.5 1H3.5C2.675 1 2.0075 1.63 2.0075 2.4L2 13.6C2 14.37 2.6675 15 3.4925 15H12.5C13.325 15 14 14.37 14 13.6V5.2L9.5 1ZM3.5 13.6V2.4H8.75L12.5 5.9V13.6H3.5Z"/>\n    <rect x="7" y="10.5" width="4" height="0.999998"/>\n    <rect x="5" y="5.49988" width="4" height="0.999998"/>\n    <rect x="7.5" y="4" width="4" height="1" transform="rotate(90 7.5 4)"/>\n  </g>\n</svg>\n'}),ze=new g.LabIcon({name:"git:discard",svgstr:'<svg\n   xmlns="http://www.w3.org/2000/svg"\n   width="16"\n   viewBox="0 0 24 24"\n   version="1.1">\n  <g class="jp-icon3 jp-icon-selectable" stroke="#4F4F4F" stroke-width="2px">\n    <path\n       fill="none"\n       d="m 8.9223529,22.334118 c 0,0 8.2027491,-6.710405 10.3905881,-10.164706 C 21.50078,8.7151116 20.317794,5.8252391 17.957647,3.5011764 15.597501,1.1771138 12.452863,1.6307769 9.8541176,2.1458824 7.2553727,2.6609879 3.1905882,5.8164706 3.1905882,5.8164706" \n      />\n    <path\n       fill="none"\n       d="M 5.3082353,0.90352943 3.1905882,5.8164706 8.0752941,6.6070589"\n      />\n  </g>\n</svg>\n'}),He=new g.LabIcon({name:"git:insertions",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path class="jp-icon3" fill="white" d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n'}),Ue=new g.LabIcon({name:"git:open-file",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 15 15">\n  <g class="jp-icon3 jp-icon-selectable" fill="#4F4F4F">\n    <path\n       d="m 6.5,1 h 6 c 0.825,0 1.4925,0.63 1.4925,1.4 L 14,13.6 C 14,14.37 13.3325,15 12.5075,15 H 3.5 C 2.675,15 2,14.37 2,13.6 V 5.2 Z m 6,12.6 V 2.4 H 7.25 L 3.5,5.9 v 7.7 z"/>\n    <path\n       d="M 7.5195314,11.679686 V 9.3359374 l -2.8320313,-1e-7 V 8.457031 7.5781248 h 2.8320313 v -2.34375 l 4.0527336,3.2226563 z"\n       style="stroke-width:2.66873717" />\n  </g>\n</svg>\n'}),Ge=new g.LabIcon({name:"git:pull",svgstr:'<svg width="16" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path class="jp-icon3" \n    d="M14.5125 7.53C14.0025 4.9425 11.73 3 9 3C6.8325 3 4.95 4.23 4.0125 6.03C1.755 6.27 0 8.1825 0 10.5C0 12.9825 2.0175 15 4.5 15H14.25C16.32 15 18 13.32 18 11.25C18 9.27 16.4625 7.665 14.5125 7.53ZM14.25 13.5H4.5C2.8425 13.5 1.5 12.1575 1.5 10.5C1.5 8.9625 2.6475 7.68 4.17 7.5225L4.9725 7.44L5.3475 6.7275C6.06 5.355 7.455 4.5 9 4.5C10.965 4.5 12.66 5.895 13.0425 7.8225L13.2675 8.9475L14.415 9.03C15.585 9.105 16.5 10.0875 16.5 11.25C16.5 12.4875 15.4875 13.5 14.25 13.5ZM10.0875 7.5H7.9125V9.75H6L9 12.75L12 9.75H10.0875V7.5Z" \n    fill="#4F4F4F"/>\n</svg>\n'}),We=new g.LabIcon({name:"git:push",svgstr:'<svg width="16" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n<path class="jp-icon3" d="M14.5125 7.53C14.0025 4.9425 11.73 3 9 3C6.8325 3 4.95 4.23 4.0125 6.03C1.755 6.27 0 8.1825 0 10.5C0 12.9825 2.0175 15 4.5 15H14.25C16.32 15 18 13.32 18 11.25C18 9.27 16.4625 7.665 14.5125 7.53ZM14.25 13.5H4.5C2.8425 13.5 1.5 12.1575 1.5 10.5C1.5 8.9625 2.6475 7.68 4.17 7.5225L4.9725 7.44L5.3475 6.7275C6.06 5.355 7.455 4.5 9 4.5C10.965 4.5 12.66 5.895 13.0425 7.8225L13.2675 8.9475L14.415 9.03C15.585 9.105 16.5 10.0875 16.5 11.25C16.5 12.4875 15.4875 13.5 14.25 13.5ZM6 9.75H7.9125V12H10.0875V9.75H12L9 6.75L6 9.75Z" fill="#4F4F4F"/>\n</svg>\n'}),Ve=new g.LabIcon({name:"git:remove",svgstr:'<svg\n   xmlns="http://www.w3.org/2000/svg"\n   width="16"\n   viewBox="0 0 24 24"\n   version="1.1">\n  <g class="jp-icon3 jp-icon-selectable" stroke="#4F4F4F" stroke-width="2px">\n  <path\n     fill="none"\n     d="M 2,12 H 22" />\n   </g>\n</svg>\n'}),$e=new g.LabIcon({name:"git:rewind",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 24 24">\n    <path class="jp-icon3" fill="#4F4F4F" d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>\n</svg>\n'}),Ze=new g.LabIcon({name:"git:tag",svgstr:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 512.001 512.001" width="16">\n\t<path class="jp-icon3" fill="#4F4F4F" d="M506.513,311.066L253.87,58.423c-2.024-2.026-4.486-3.559-7.195-4.483L140.15,17.593\n\t\t\tc-6.758-2.305-14.242-0.568-19.294,4.483L84.709,58.222L31.977,5.491c-7.314-7.315-19.176-7.315-26.49,0\n\t\t\tc-7.315,7.315-7.315,19.175,0,26.49l52.732,52.731l-36.14,36.141c-5.051,5.05-6.79,12.534-4.483,19.294L53.943,246.67\n\t\t\tc0.924,2.71,2.458,5.172,4.483,7.197L311.071,506.51c7.314,7.315,19.175,7.315,26.49,0l168.954-168.954\n\t\t\tC513.83,330.241,513.83,318.382,506.513,311.066z M227.241,227.238c-21.817,21.819-57.132,21.82-78.952,0\n\t\t\tc-21.768-21.768-21.768-57.185,0.001-78.953c21.817-21.819,57.132-21.82,78.953,0C249.009,170.053,249.009,205.47,227.241,227.238\n\t\t\tz"/>\n</svg>\n'}),Ke=new g.LabIcon({name:"git:trash",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 24 24">\n    <path class="jp-icon3" fill="#4F4F4F" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n'}),qe=e=>{const{disabled:t,className:s,title:i,onClick:r,icon:n}=e;return _.createElement("button",{disabled:t,className:(0,Re.classes)(De,s),title:i,onClick:r},_.createElement(n.react,{elementPosition:"center",tag:"span"}))},Xe=(0,Re.style)({display:"flex",flexDirection:"row",alignItems:"center",boxSizing:"border-box",color:"var(--jp-ui-font-color1)",lineHeight:"var(--jp-private-running-item-height)",padding:"0px 4px",listStyleType:"none",$nest:{"&:hover":{backgroundColor:"var(--jp-layout-color2)"}}},Ne),Ye=(0,Re.style)({color:"white",background:"var(--jp-brand-color1)",$nest:{"&:hover":{color:"white",background:"var(--jp-brand-color1) !important"},"&:hover .jp-icon-selectable[fill]":{fill:"white"},"&:hover .jp-icon-selectable[stroke]":{stroke:"white"},"& .jp-icon-selectable[fill]":{fill:"white"},"& .jp-icon-selectable-inverse[fill]":{fill:"var(--jp-brand-color1)"}}}),Je=(0,Re.style)({fontSize:"10px",marginLeft:"5px"}),Qe=(0,Re.style)({color:"white !important"}),et=(0,Re.style)({color:"var(--jp-brand-color0)"}),tt=(0,Re.style)({color:"var(--jp-info-color0)"}),st=((0,Re.style)({display:"none"}),(0,Re.style)({marginTop:"5px"}),(0,Re.style)({flex:"0 0 auto"})),it=(0,Re.style)({flex:"0 0 auto",height:"16px",width:"16px",marginRight:"4px"}),rt=(0,Re.style)({flex:"1 1 auto",fontSize:"var(--jp-ui-font-size1)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),nt=(0,Re.style)({color:"var(--jp-ui-font-color2)",fontSize:"var(--jp-ui-font-size0)",margin:"0px 4px"}),ot=e=>{const t="/"===(s=e.filepath)[s.length-1]?s:p.PathExt.basename(s);var s;const i=e.filepath.slice(0,e.filepath.length-t.length).replace(/^\/|\/$/g,""),r=e.filetype.icon||g.fileIcon;return _.createElement(_.Fragment,null,_.createElement(r.react,{className:it,elementPosition:"center",tag:"span"}),_.createElement("span",{className:rt},t,_.createElement("span",{className:nt},i)))},at={M:"Modified",A:"Added",D:"Deleted",R:"Renamed",C:"Copied",U:"Updated","?":"Untracked","!":"Ignored"};class lt extends _.PureComponent{constructor(){super(...arguments),this._onClick=()=>{this.props.model.toggleMark(this.props.fname),this.forceUpdate()},this._onDoubleClick=e=>{e.stopPropagation()}}render(){return this.props.model.addMark(this.props.fname,"untracked"!==this.props.stage),_.createElement("input",{name:"gitMark",className:st,type:"checkbox",checked:this.props.model.getMark(this.props.fname),onChange:this._onClick,onDoubleClick:this._onDoubleClick})}}class ct extends _.PureComponent{constructor(e){super(e)}_getFileChangedLabel(e){return at[e]}_getFileChangedLabelClass(e){return"M"===e?this.props.selected?(0,Re.classes)(Je,et,Qe):(0,Re.classes)(Je,et):this.props.selected?(0,Re.classes)(Je,tt,Qe):(0,Re.classes)(Je,tt)}_getFileClass(){return this.props.selected?(0,Re.classes)(Xe,Ye):Xe}render(){const{file:e}=this.props,t="staged"===e.status?e.x:e.y,s=this._getFileChangedLabel(t);return _.createElement("div",{className:this._getFileClass(),onClick:this.props.selectFile&&(()=>this.props.selectFile(this.props.file)),onContextMenu:this.props.contextMenu&&(e=>{this.props.contextMenu(this.props.file,e)}),onDoubleClick:this.props.onDoubleClick,style:this.props.style,title:this.props.trans.__(`%1 ● ${s}`,this.props.file.to)},this.props.markBox&&_.createElement(lt,{fname:this.props.file.to,stage:this.props.file.status,model:this.props.model}),_.createElement(ot,{filepath:this.props.file.to,filetype:this.props.file.type}),this.props.actions,_.createElement("span",{className:this._getFileChangedLabelClass(this.props.file.y)},"?"===this.props.file.y?"U":t))}}var ht=s(737);const dt=(0,Re.style)({margin:"0",padding:"0",overflow:"auto",$nest:{"& button:disabled":{opacity:.5}}}),pt=(0,Re.style)({display:"flex",flexDirection:"row",alignItems:"center",margin:"4px 0px",padding:"4px",fontWeight:600,borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)",letterSpacing:"1px",fontSize:"12px",$nest:{"&:hover":{backgroundColor:"var(--jp-layout-color2)"}}},Ne),gt=(0,Re.style)({fontSize:"var(--jp-ui-font-size1)",flex:"1 1 auto",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),mt=(0,Re.style)({fontSize:"var(--jp-ui-font-size1)",flex:"0 0 auto",whiteSpace:"nowrap",borderRadius:"2px"}),ut=(0,Re.style)({flex:"0 0 auto",backgroundColor:"transparent",height:"13px",width:"12px",border:"none",outline:"none",paddingLeft:"0px"}),ft=e=>{const[t,s]=_.useState(!0),i=e.files.length;return _.createElement("div",{className:dt},_.createElement("div",{className:pt,onClick:()=>{e.collapsible&&i>0&&s(!t)}},e.collapsible&&_.createElement("button",{className:ut},t&&i>0?_.createElement(g.caretDownIcon.react,null):_.createElement(g.caretRightIcon.react,null)),_.createElement("span",{className:gt},e.heading),e.actions,_.createElement("span",{className:mt},"(",i,")")),t&&i>0&&_.createElement(ht.FixedSizeList,{height:Math.max(Math.min(e.height-34,25*i),25),itemCount:i,itemData:e.files,itemKey:(e,t)=>t[e].to,itemSize:25,style:{overflowX:"hidden"},width:"auto"},e.rowRenderer))},_t={"partially-staged":[_e.gitFileOpen,_e.gitFileUnstage,_e.gitFileDiff],unstaged:[_e.gitFileOpen,_e.gitFileStage,_e.gitFileDiscard,_e.gitFileDiff],untracked:[_e.gitFileOpen,_e.gitFileTrack,_e.gitIgnore,_e.gitIgnoreExtension,_e.gitFileDelete],staged:[_e.gitFileOpen,_e.gitFileUnstage,_e.gitFileDiff]},bt={"partially-staged":[_e.gitFileOpen,_e.gitFileDiscard,_e.gitFileDiff],staged:[_e.gitFileOpen,_e.gitFileDiscard,_e.gitFileDiff],unstaged:[_e.gitFileOpen,_e.gitFileDiscard,_e.gitFileDiff],untracked:[_e.gitFileOpen,_e.gitIgnore,_e.gitIgnoreExtension,_e.gitFileDelete]};class yt extends _.Component{constructor(e){super(e),this.openContextMenu=(e,t)=>{t.preventDefault(),this.setState({selectedFile:e});const s=new f.Menu({commands:this.props.commands});Ft(_t[e.status],s,[e]),s.open(t.clientX,t.clientY)},this.openSimpleContextMenu=(e,t)=>{t.preventDefault();const s=new f.Menu({commands:this.props.commands});Ft(bt[e.status],s,[e]),s.open(t.clientX,t.clientY)},this.resetAllStagedFiles=async e=>{e.stopPropagation(),await this.props.model.reset()},this.resetStagedFile=async e=>{await this.props.model.reset(e)},this.addAllUnstagedFiles=async e=>{e.stopPropagation(),await this.props.model.addAllUnstaged()},this.discardAllUnstagedFiles=async e=>{if(e.stopPropagation(),(await(0,r.showDialog)({title:this.props.trans.__("Discard all changes"),body:this.props.trans.__("Are you sure you want to permanently discard changes to all files? This action cannot be undone."),buttons:[r.Dialog.cancelButton({label:this.props.trans.__("Cancel")}),r.Dialog.warnButton({label:this.props.trans.__("Discard")})]})).button.accept)try{await this.props.model.checkout()}catch(e){(0,r.showErrorMessage)(this.props.trans.__("Discard all unstaged changes failed."),e)}},this.discardAllChanges=async e=>{if(e.stopPropagation(),(await(0,r.showDialog)({title:this.props.trans.__("Discard all changes"),body:this.props.trans.__("Are you sure you want to permanently discard changes to all files? This action cannot be undone."),buttons:[r.Dialog.cancelButton({label:this.props.trans.__("Cancel")}),r.Dialog.warnButton({label:this.props.trans.__("Discard")})]})).button.accept)try{await this.props.model.resetToCommit()}catch(e){(0,r.showErrorMessage)(this.props.trans.__("Discard all changes failed."),e)}},this.addFile=async(...e)=>{await this.props.model.add(...e)},this.discardChanges=async e=>{await this.props.commands.execute(_e.gitFileDiscard,{files:[e]})},this.addAllUntrackedFiles=async e=>{e.stopPropagation(),await this.props.model.addAllUntracked()},this.addAllMarkedFiles=async()=>{await this.addFile(...this.markedFiles.map((e=>e.to)))},this.updateSelectedFile=e=>{this.setState({selectedFile:e})},this._renderStagedRow=e=>{const t=this.props.settings.get("doubleClickDiff").composite,{data:s,index:i,style:r}=e,n=s[i],o=()=>{this.props.commands.execute(_e.gitFileOpen,{files:[n]})},a=this._createDiffButton(n);return _.createElement(ct,{trans:this.props.trans,actions:_.createElement(_.Fragment,null,_.createElement(qe,{className:je,icon:Ue,title:this.props.trans.__("Open this file"),onClick:o}),a,_.createElement(qe,{className:je,icon:Ve,title:this.props.trans.__("Unstage this change"),onClick:()=>{this.resetStagedFile(n.to)}})),file:n,contextMenu:this.openContextMenu,model:this.props.model,selected:this._isSelectedFile(n),selectFile:this.updateSelectedFile,onDoubleClick:t?a?()=>this._openDiffView(n):()=>{}:o,style:r})},this._renderChangedRow=e=>{const t=this.props.settings.get("doubleClickDiff").composite,{data:s,index:i,style:r}=e,n=s[i],o=()=>{this.props.commands.execute(_e.gitFileOpen,{files:[n]})},a=this._createDiffButton(n);return _.createElement(ct,{trans:this.props.trans,actions:_.createElement(_.Fragment,null,_.createElement(qe,{className:je,icon:Ue,title:this.props.trans.__("Open this file"),onClick:o}),a,_.createElement(qe,{className:je,icon:ze,title:this.props.trans.__("Discard changes"),onClick:()=>{this.discardChanges(n)}}),_.createElement(qe,{className:je,icon:Te,title:this.props.trans.__("Stage this change"),onClick:()=>{this.addFile(n.to)}})),file:n,contextMenu:this.openContextMenu,model:this.props.model,selected:this._isSelectedFile(n),selectFile:this.updateSelectedFile,onDoubleClick:t?a?()=>this._openDiffView(n):()=>{}:o,style:r})},this._renderUntrackedRow=e=>{const t=this.props.settings.get("doubleClickDiff").composite,{data:s,index:i,style:r}=e,n=s[i];return _.createElement(ct,{trans:this.props.trans,actions:_.createElement(_.Fragment,null,_.createElement(qe,{className:je,icon:Ue,title:this.props.trans.__("Open this file"),onClick:()=>{this.props.commands.execute(_e.gitFileOpen,{files:[n]})}}),_.createElement(qe,{className:je,icon:Te,title:this.props.trans.__("Track this file"),onClick:()=>{this.addFile(n.to)}})),file:n,contextMenu:this.openContextMenu,model:this.props.model,onDoubleClick:()=>{t||this.props.commands.execute(_e.gitFileOpen,{files:[n]})},selected:this._isSelectedFile(n),selectFile:this.updateSelectedFile,style:r})},this._renderSimpleStageRow=e=>{const{data:t,index:s,style:i}=e,r=t[s],n=this.props.settings.get("doubleClickDiff").composite,o=()=>{this.props.commands.execute(_e.gitFileOpen,{files:[r]})};let a=_.createElement(qe,{className:je,icon:Ue,title:this.props.trans.__("Open this file"),onClick:o}),l=n?()=>{}:o;if("unstaged"===r.status||"partially-staged"===r.status){const e=this._createDiffButton(r);a=_.createElement(_.Fragment,null,_.createElement(qe,{className:je,icon:Ue,title:this.props.trans.__("Open this file"),onClick:o}),e,_.createElement(qe,{className:je,icon:ze,title:this.props.trans.__("Discard changes"),onClick:()=>{this.discardChanges(r)}})),l=n?e?()=>this._openDiffView(r):()=>{}:o}else if("staged"===r.status){const e=this._createDiffButton(r);a=_.createElement(_.Fragment,null,_.createElement(qe,{className:je,icon:Ue,title:this.props.trans.__("Open this file"),onClick:o}),e,_.createElement(qe,{className:je,icon:ze,title:this.props.trans.__("Discard changes"),onClick:()=>{this.discardChanges(r)}})),l=n?e?()=>this._openDiffView(r):()=>{}:o}return _.createElement(ct,{trans:this.props.trans,actions:a,file:r,markBox:!0,model:this.props.model,onDoubleClick:l,contextMenu:this.openSimpleContextMenu,selectFile:this.updateSelectedFile,style:i})},this.state={selectedFile:null}}get markedFiles(){return this.props.files.filter((e=>this.props.model.getMark(e.to)))}render(){if(this.props.settings.composite.simpleStaging)return _.createElement("div",{className:Be},_.createElement(he(),{disableWidth:!0},(({height:e})=>this._renderSimpleStage(this.props.files,e))));{const e=[],t=[],s=[];return this.props.files.forEach((i=>{switch(i.status){case"staged":e.push(i);break;case"unstaged":t.push(i);break;case"untracked":s.push(i);break;case"partially-staged":e.push(Object.assign(Object.assign({},i),{status:"staged"})),t.push(Object.assign(Object.assign({},i),{status:"unstaged"}))}})),_.createElement("div",{className:Be,onContextMenu:e=>e.preventDefault()},_.createElement(he(),{disableWidth:!0},(({height:i})=>_.createElement(_.Fragment,null,this._renderStaged(e,i),this._renderChanged(t,i),this._renderUntracked(s,i)))))}}_isSelectedFile(e){return null!==this.state.selectedFile&&this.state.selectedFile.x===e.x&&this.state.selectedFile.y===e.y&&this.state.selectedFile.from===e.from&&this.state.selectedFile.to===e.to&&this.state.selectedFile.status===e.status}_renderStaged(e,t){return _.createElement(ft,{actions:_.createElement(qe,{className:je,disabled:0===e.length,icon:Ve,title:this.props.trans.__("Unstage all changes"),onClick:this.resetAllStagedFiles}),collapsible:!0,files:e,heading:this.props.trans.__("Staged"),height:t,rowRenderer:this._renderStagedRow})}_renderChanged(e,t){const s=0===e.length;return _.createElement(ft,{actions:_.createElement(_.Fragment,null,_.createElement(qe,{className:je,disabled:s,icon:ze,title:this.props.trans.__("Discard All Changes"),onClick:this.discardAllUnstagedFiles}),_.createElement(qe,{className:je,disabled:s,icon:Te,title:this.props.trans.__("Stage all changes"),onClick:this.addAllUnstagedFiles})),collapsible:!0,heading:this.props.trans.__("Changed"),height:t,files:e,rowRenderer:this._renderChangedRow})}_renderUntracked(e,t){return _.createElement(ft,{actions:_.createElement(qe,{className:je,disabled:0===e.length,icon:Te,title:this.props.trans.__("Track all untracked files"),onClick:this.addAllUntrackedFiles}),collapsible:!0,heading:this.props.trans.__("Untracked"),height:t,files:e,rowRenderer:this._renderUntrackedRow})}_renderSimpleStage(e,t){return _.createElement(ft,{actions:_.createElement(qe,{className:je,disabled:0===e.length,icon:ze,title:this.props.trans.__("Discard All Changes"),onClick:this.discardAllChanges}),heading:this.props.trans.__("Changed"),height:t,files:e,rowRenderer:this._renderSimpleStageRow})}_createDiffButton(e){return(xe(e.to)||!e.is_binary)&&_.createElement(qe,{className:je,icon:Ae,title:this.props.trans.__("Diff this file"),onClick:()=>this._openDiffView(e)})}async _openDiffView(e){try{await this.props.commands.execute(_e.gitFileDiff,{files:[{filePath:e.to,isText:!e.is_binary,status:e.status}]})}catch(t){console.error(`Failed to open diff view for ${e.to}.\n${t}`)}}}const vt=new class{constructor(){this._signal=new y.Signal(this)}get signal(){return this._signal}log(e){this._signal.emit(e)}},wt=_.createContext(vt);class Ct extends f.Widget{constructor(e,t=e.__("Enter credentials for remote repository"),s=""){super(),this._trans=e,this.node.appendChild(this.createBody(t,s))}createBody(e,t){const s=document.createElement("div"),i=document.createElement("label");this._user=document.createElement("input"),this._password=document.createElement("input"),this._password.type="password";const r=document.createElement("span"),n=document.createElement("div");return s.className="jp-RedirectForm",n.className="jp-RedirectForm-warning",r.textContent=e,n.textContent=t,this._user.placeholder=this._trans.__("username"),this._password.placeholder=this._trans.__("password / personal access token"),i.appendChild(r),i.appendChild(this._user),i.appendChild(this._password),s.appendChild(i),s.appendChild(n),s}getValue(){return{username:this._user.value,password:this._password.value}}}class kt extends f.Widget{constructor(e){super({node:kt.createFormNode(e)})}getValue(){return encodeURIComponent(this.node.querySelector("input").value)}static createFormNode(e){const t=document.createElement("div"),s=document.createElement("label"),i=document.createElement("input"),r=document.createElement("span");return t.className="jp-RedirectForm",r.textContent=e.__("Enter the Clone URI of the repository"),i.placeholder="https://host.com/org/repo.git",s.appendChild(r),s.appendChild(i),t.appendChild(s),t}}var xt,Et;function St(e,t){return s=>{const{files:i}=s;return i.length>1?t:e}}function Ft(e,t,s){e.forEach((e=>{e===_e.gitFileDiff?t.addItem({command:e,args:{files:s.map((e=>({filePath:e.to,isText:!e.is_binary,status:e.status})))}}):t.addItem({command:e,args:{files:s}})}))}!function(e){e.Clone="Clone",e.Pull="Pull",e.Push="Push"}(xt||(xt={})),function(e){e.showGitOperationDialog=async function e(t,s,i,n,o,a=!1){try{let e;switch(s){case xt.Clone:const{path:s,url:i}=n;e=await t.clone(s,i,o);break;case xt.Pull:e=await t.pull(o);break;case xt.Push:e=await t.push(o);break;default:e={code:-1,message:"Unknown git command"}}return e.message}catch(o){if(ye.some((e=>o.message.indexOf(e)>-1))){const o=await(0,r.showDialog)({title:i.__("Git credentials required"),body:new Ct(i,i.__("Enter credentials for remote repository"),a?i.__("Incorrect username or password."):"")});if(o.button.accept)return await e(t,s,i,n,o.value,!0)}throw o}}}(Et||(Et={}));var Rt=s(3127),Dt=s(7842),jt=s(5494);const Nt="jp-mod-hideUnchanged";class Bt extends f.Panel{constructor(e,t){super(),this._areUnchangedCellsHidden=!1;const s=new u.PromiseDelegate;this._isReady=s.promise,this._model=e,this._renderMime=t,this.addClass("nbdime-Widget"),this.refresh().then((()=>{s.resolve()})).catch((e=>{console.error("Failed to refresh Notebook diff.",e,null==e?void 0:e.traceback)}))}get areUnchangedCellsHidden(){return this._areUnchangedCellsHidden}set areUnchangedCellsHidden(e){this._areUnchangedCellsHidden!==e&&(It.toggleShowUnchanged(this._scroller,this._areUnchangedCellsHidden),this._areUnchangedCellsHidden=e)}get ready(){return this._isReady}async refresh(){var e;if(!(null===(e=this._scroller)||void 0===e?void 0:e.parent)){for(;this.widgets.length>0;)this.widgets[0].dispose();const e=It.diffHeader(this._model.reference.label,this._model.challenger.label);this.addWidget(e),this._scroller=new f.Panel,this._scroller.addClass("nbdime-root"),this._scroller.node.tabIndex=-1,this.addWidget(this._scroller)}try{const e=await this._model.reference.content(),t=await this._model.challenger.content(),s=await this.createDiffView(t,e);for(;this._scroller.widgets.length>0;)this._scroller.widgets[0].dispose();this._scroller.addWidget(s);try{await s.init(),It.markUnchangedRanges(this._scroller.node)}catch(e){console.debug(`Failed to init notebook diff view: ${e}`),It.markUnchangedRanges(this._scroller.node)}}catch(e){this.showError(e)}}async createDiffView(e,t){const s=await ve("diffnotebook","POST",{currentContent:e,previousContent:t}),i=new Rt.NotebookDiffModel(s.base,s.diff);return new Dt.NotebookDiffWidget(i,this._renderMime)}onActivateRequest(e){var t;(null===(t=this._scroller)||void 0===t?void 0:t.parent)&&this._scroller.node.focus()}showError(e){var t;for(console.error("Failed to load file diff.",e,null===(t=e)||void 0===t?void 0:t.traceback);this.widgets.length>0;)this.widgets[0].dispose();const s=(e.message||e).replace("\n","<br />");this.node.innerHTML=`<p class="jp-git-diff-error">\n      <span>Error Loading Notebook Diff:</span>\n      <span class="jp-git-diff-error-message">${s}</span>\n    </p>`}}var It;!function(e){function t(e){if(!e.parentElement||!e.parentElement.parentElement)return e;const t=e.parentElement.parentElement;return t.classList.contains(jt.CHUNK_PANEL_CLASS)?t:e}function s(e){const s=e.querySelectorAll(`.${Dt.CELLDIFF_CLASS}`);let i=-1;for(let e=0;e<s.length;++e){const r=s[e];if(r.classList.contains(jt.UNCHANGED_DIFF_CLASS))-1===i&&(i=e);else if(-1!==i){const s=e-i;t(r).setAttribute("data-nbdime-NCellsHiddenBefore",s.toString()),i=-1}}if(-1!==i){const r=s.length-i;if(0===i)return void(e.querySelector(".jp-Notebook-diff")||e).setAttribute("data-nbdime-AllCellsHidden",r.toString());t(s[i-1]).setAttribute("data-nbdime-NCellsHiddenAfter",r.toString())}}e.diffHeader=function(e,t){const s=document.createElement("div");return s.className="jp-git-diff-header",s.innerHTML=`<div class="jp-git-diff-banner">\n        <span>${e}</span>\n        <span class="jp-spacer"></span>\n        <span>${t}</span>\n      </div>`,new f.Widget({node:s})},e.toggleShowUnchanged=function(e,t){const i=e.hasClass(Nt);if(void 0===t)t=i;else if(i!==t)return;t?e.removeClass(Nt):(s(e.node),e.addClass(Nt)),e.update()},e.markUnchangedRanges=s}(It||(It={}));const Tt=(0,Re.keyframes)({to:{fillOpacity:1}}),Mt=(0,Re.style)({$nest:{"& .jp-icon3":{animationName:Tt,animationDuration:"1s"}}}),Pt=(0,Re.keyframes)({"0%":{fillOpacity:1},"50%":{fillOpacity:.6},"100%":{fillOpacity:1}}),Ot=(0,Re.style)({$nest:{"& .jp-icon3":{animationName:Pt,animationDuration:"2s",animationIterationCount:"infinite"}}});class Lt extends r.ReactWidget{constructor(e){super(),this._locked=!1,this._status="",this._trans=e}set status(e){this._status=e,this._locked||this._animate()}render(){return b().createElement("div",{title:`Git: ${this._trans.__(this._status)}`},b().createElement(Ie.react,{className:"idle"!==this._status?Ot:Mt,left:"1px",top:"3px",stylesheet:"statusBar"}))}async _animate(){this._locked=!0,this.update(),await(500,new Promise((e=>setTimeout(e,500)))),this._locked=!1,this.update()}}var At;!function(e){e.createEventCallback=function(e){return function(t,s){let i;switch(s){case"empty":i="idle";break;case"git:checkout":i="checking out...";break;case"git:clone":i="cloning repository...";break;case"git:commit:create":i="committing changes...";break;case"git:commit:revert":i="reverting changes...";break;case"git:init":i="initializing repository...";break;case"git:pull":i="pulling changes...";break;case"git:pushing":i="pushing changes...";break;case"git:refresh":i="refreshing...";break;case"git:reset:changes":i="resetting changes...";break;case"git:reset:hard":i="discarding changes...";break;default:i=/git:add:files/.test(s)?"adding files...":"working..."}e.status=i}},e.isStatusWidgetActive=function(e){return e?function(){return e.composite.displayStatus}:function(){return!1}}}(At||(At={}));var zt=s(6393),Ht=s(6234),Ut=s(2285),Gt=s(5917),Wt=s(8715);function Vt(e){return _.createElement(Ut.Z,Object.assign({},e,{direction:"up"}))}class $t extends _.Component{constructor(e){super(e),this._onClick=e=>{this.props.onClick?this.props.onClick(e):this._onClose(e,"click")},this._onClose=(e,t)=>{"clickaway"!==t&&this.props.onClose(e)}}render(){let e=null;const t=this.props.severity||"info";let s;return"success"===t&&(e=this.props.duration||5e3),this.props.error?s=_.createElement(zt.Button,{color:"inherit",size:"small",onClick:()=>{(0,r.showErrorMessage)(this.props.trans.__("Error"),this.props.error,[r.Dialog.warnButton({label:this.props.trans.__("Dismiss")})])}},this.props.trans.__("SHOW")):this.props.details&&(s=_.createElement(zt.Button,{color:"inherit",size:"small",onClick:()=>{(0,r.showDialog)({title:this.props.trans.__("Detailed message"),body:this.props.details,buttons:[r.Dialog.okButton({label:this.props.trans.__("DISMISS")})]})}},this.props.trans.__("Details"))),_.createElement(Ht.Z,null,_.createElement(Gt.Z,{key:"git:alert",open:this.props.open,anchorOrigin:{vertical:"bottom",horizontal:"right"},autoHideDuration:e,TransitionComponent:Vt,onClick:this._onClick,onClose:this._onClose},_.createElement(Wt.Z,{action:s,variant:"filled",severity:t},this.props.message||this.props.trans.__("(missing message)"))))}}var Zt=s(6015),Kt=s(5477);const qt=(0,Re.style)({position:"absolute",top:"50%",left:"50%",color:"var(--jp-ui-inverse-font-color0)",textAlign:"center"});class Xt extends _.Component{constructor(e){super(e),this._onClick=e=>{this.props.onClick&&this.props.onClick(e)}}render(){return _.createElement(Zt.Z,{disableAutoFocus:!0,disableEnforceFocus:!0,open:this.props.open,onClick:this._onClick},_.createElement("div",{className:qt},_.createElement(Kt.Z,{color:"inherit"})))}}const Yt=new Map([[fe.ERROR,"error"],[fe.WARNING,"warning"],[fe.SUCCESS,"success"],[fe.INFO,"info"],[fe.RUNNING,"info"]]),Jt=1e3;class Qt extends _.Component{constructor(e){super(e),this.state={blockUI:!1,lastUpdate:Date.now()-Jt,logStack:[],showAlert:!1}}static getDerivedStateFromProps(e,t){const s=t.logStack[t.logStack.length-1],i=Date.now();return e.log!==s&&(i-t.lastUpdate>Jt&&t.logStack.shift(),s&&e.log.level>s.level?(t.logStack.splice(0,1,e.log),t.lastUpdate=i):t.logStack.push(e.log),t.blockUI=e.settings.composite.blockWhileCommandExecutes,t.showAlert=!0),t}render(){this.state.logStack.length>1&&setTimeout((()=>{this.state.logStack.length>1&&this.setState({blockUI:this.props.settings.composite.blockWhileCommandExecutes,logStack:this.state.logStack.slice(1),lastUpdate:Date.now(),showAlert:!0})}),Jt);const e=this.state.logStack[0];return _.createElement(_.Fragment,null,_.createElement(Xt,{open:this.state.blockUI&&e.level===fe.RUNNING&&this.state.showAlert,onClick:()=>{this.setState({blockUI:!1})}}),_.createElement($t,{details:null==e?void 0:e.details,error:null==e?void 0:e.error,open:this.state.showAlert,message:(null==e?void 0:e.message)||this.props.log.message,severity:Yt.get((null==e?void 0:e.level)||this.props.log.level),onClose:()=>this.setState({showAlert:!1}),trans:this.props.trans}))}}var es=s(1423),ts=s(8998);const ss=(0,Re.style)({display:"flex",flexDirection:"column",height:"100%",overflowY:"auto"}),is=(0,Re.style)({fontSize:"var(--jp-ui-font-size1)",lineHeight:"var(--jp-content-line-height)",margin:"13px 11px 4px 11px",textAlign:"left"}),rs=(0,Re.style)({alignSelf:"center",boxSizing:"border-box",height:"2em",width:"12em",marginTop:"5px",border:"0",borderRadius:"3px",color:"white",fontSize:"var(--jp-ui-font-size1)",backgroundColor:"var(--md-blue-500)",$nest:{"&:hover":{backgroundColor:"var(--md-blue-600)"},"&:active":{backgroundColor:"var(--md-blue-700)"}}}),ns=(0,Re.style)({minHeight:"36px!important",$nest:{"button:last-of-type":{borderRight:"none"}}}),os=(0,Re.style)({width:"50%",minWidth:"0!important",maxWidth:"50%!important",minHeight:"36px!important",backgroundColor:"var(--jp-layout-color2)!important",borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)!important",borderRight:"var(--jp-border-width) solid var(--jp-border-color2)!important",$nest:{span:{textTransform:"none"}}}),as=(0,Re.style)({backgroundColor:"var(--jp-layout-color1)!important"}),ls=(0,Re.style)({height:"3px!important",backgroundColor:"var(--jp-brand-color1)!important",transition:"none!important"});class cs extends f.Widget{constructor(){super(),this.node.appendChild(this.createBody())}createBody(){const e=document.createElement("div"),t=document.createElement("span");return this._name=document.createElement("input"),this._email=document.createElement("input"),e.className="jp-RedirectForm",t.textContent="Enter your name and email for commit",this._name.placeholder="Name",this._email.placeholder="Email",e.appendChild(t),e.appendChild(this._name),e.appendChild(this._email),e}getValue(){return{name:this._name.value,email:this._email.value}}}var hs=s(4968),ds=s(1624),ps=s.n(ds);const gs=(0,Re.style)({display:"flex",flexWrap:"wrap",marginTop:"auto",padding:"8px",paddingTop:"1em",alignItems:"flex-start",backgroundColor:"var(--jp-layout-color1)",borderTop:"var(--jp-border-width) solid var(--jp-border-color2)"}),ms=(0,Re.style)({width:"100%",height:"1.5em",marginBottom:"1em",padding:"var(--jp-code-padding)",outline:"none",overflowX:"auto",color:"var(--jp-ui-font-color1)",fontSize:"var(--jp-ui-font-size1)",fontWeight:300,backgroundColor:"var(--jp-layout-color1)",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",$nest:{"&:active":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&:focus":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"}}}),us=(0,Re.style)({width:"100%",marginBottom:"1em",padding:"var(--jp-code-padding)",outline:"none",overflowX:"auto",resize:"none",color:"var(--jp-ui-font-color1)",fontSize:"var(--jp-ui-font-size1)",fontWeight:300,backgroundColor:"var(--jp-layout-color1)",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",$nest:{"&:focus":{outline:"none",border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&:active":{outline:"none",border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&::placeholder":{color:"var(--jp-ui-font-color3)"},"&::-webkit-input-placeholder":{color:"var(--jp-ui-font-color3)"},"&::-moz-placeholder":{color:"var(--jp-ui-font-color3)"},"&::-ms-input-placeholder":{color:"var(--jp-ui-font-color3)"}}}),fs=(0,Re.style)({width:"100%",height:"2em",marginBottom:"0.5em",color:"white",fontSize:"var(--jp-ui-font-size1)",cursor:"pointer",backgroundColor:"var(--md-blue-500)",border:"0",borderRadius:"3px",$nest:{"&:hover":{backgroundColor:"var(--md-blue-600)"},"&:active":{backgroundColor:"var(--md-blue-700)"},"&:disabled":{cursor:"default",color:"var(--jp-ui-inverse-font-color0)",backgroundColor:"var(--jp-layout-color3)"},"&:disabled:hover":{backgroundColor:"var(--jp-layout-color3)"},"&:disabled:active":{backgroundColor:"var(--jp-layout-color3)"}}});class _s extends _.Component{constructor(e){super(e),this._getSubmitKeystroke=()=>this.props.commands.keyBindings.find((e=>e.command===be.gitSubmitCommand)).keys.join(" "),this._onCommitSubmit=()=>{const e=this.state.summary+"\n\n"+this.state.description+"\n";this.props.onCommit(e),this._reset()},this._onDescriptionChange=e=>{this.setState({description:e.target.value})},this._onSummaryChange=e=>{this.setState({summary:e.target.value})},this._onSummaryKeyPress=e=>{"Enter"===e.key&&e.preventDefault()},this._handleCommand=(e,t)=>{t.id===be.gitSubmitCommand&&this._canCommit()&&this._onCommitSubmit()},this.state={summary:"",description:""}}componentDidMount(){this.props.commands.commandExecuted.connect(this._handleCommand)}componentWillUnmount(){this.props.commands.commandExecuted.disconnect(this._handleCommand)}render(){const e=!this._canCommit(),t=this.props.hasFiles?this.state.summary?this.props.label:this.props.trans.__("Disabled: No commit message summary"):this.props.trans.__("Disabled: No files are staged for commit"),s=hs.CommandRegistry.formatKeystroke(this._getSubmitKeystroke()),i=this.props.trans.__("Summary (%1 to commit)",s);return _.createElement("form",{className:[gs,"jp-git-CommitBox"].join(" ")},_.createElement("input",{className:ms,type:"text",placeholder:i,title:this.props.trans.__("Enter a commit message summary (a single line, preferably less than 50 characters)"),value:this.state.summary,onChange:this._onSummaryChange,onKeyPress:this._onSummaryKeyPress}),_.createElement(ps(),{className:us,minRows:5,placeholder:this.props.trans.__("Description (optional)"),title:this.props.trans.__("Enter a commit message description"),value:this.state.description,onChange:this._onDescriptionChange}),_.createElement("input",{className:fs,type:"button",title:t,value:this.props.label,disabled:e,onClick:this._onCommitSubmit}))}_canCommit(){return!(!this.props.hasFiles||!this.state.summary)}_reset(){this.setState({summary:"",description:""})}}const bs=(0,Re.style)({display:"flex",flexDirection:"column",minHeight:"400px",marginBlockStart:0,marginBlockEnd:0,paddingLeft:0,overflowY:"auto"}),ys=(0,Re.style)({flexGrow:0,display:"flex",flexShrink:0,flexDirection:"column",padding:"5px 0px 5px 10px",borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)"}),vs=(0,Re.style)({display:"flex",color:"var(--jp-ui-font-color2)",paddingBottom:"5px"}),ws=(0,Re.style)({width:"30%",paddingLeft:"0.5em",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",$nest:{"&:first-child":{paddingLeft:0}}}),Cs=(0,Re.style)({display:"flex",fontSize:"0.8em",marginLeft:"-5px"}),ks=(0,Re.style)({padding:"2px",color:"var(--md-grey-900)",border:"var(--jp-border-width) solid var(--md-grey-700)",borderRadius:"4px",margin:"3px"}),xs=(0,Re.style)({backgroundColor:"var(--md-blue-100)"}),Es=(0,Re.style)({backgroundColor:"var(--md-orange-100)"}),Ss=(0,Re.style)({backgroundColor:"var(--md-red-100)"}),Fs=(0,Re.style)({backgroundColor:"var(--jp-layout-color1)"}),Rs=(0,Re.style)({flex:"auto"}),Ds=(0,Re.style)({width:"16px",height:"16px",margin:"auto 8px auto auto"}),js=(0,Re.style)({flex:"0 0 auto",width:"100%",fontSize:"12px",marginBottom:"10px",marginTop:"5px"}),Ns=(0,Re.style)({fontSize:"13px",fontWeight:"bold",paddingTop:"5px",$nest:{"& span":{alignItems:"center",display:"inline-flex",marginLeft:"5px"},"& span:nth-of-type(1)":{marginLeft:"0px"}}}),Bs=(0,Re.style)({flex:"1 1 auto",margin:"0"}),Is=(0,Re.style)({paddingBottom:"0.5em",fontSize:"13px",fontWeight:"bold"}),Ts=(0,Re.style)({display:"flex",flexDirection:"row",alignItems:"center",color:"var(--jp-ui-font-color1)",height:"var(--jp-private-running-item-height)",lineHeight:"var(--jp-private-running-item-height)",whiteSpace:"nowrap",overflow:"hidden",$nest:{"&:hover":{backgroundColor:"var(--jp-layout-color2)"},"&:active":{backgroundColor:"var(--jp-layout-color3)"}}}),Ms=(0,Re.style)({display:"inline-block",width:"13px",height:"13px",right:"10px"}),Ps=(0,Re.style)({$nest:{".jp-icon3":{fill:"var(--md-green-500)"}}}),Os=(0,Re.style)({$nest:{".jp-icon3":{fill:"var(--md-red-500)"}}}),Ls=(0,Re.style)({paddingLeft:0}),As=(0,Re.style)({float:"right"});var zs=s(2663),Hs=s(6856),Us=s(5996);const Gs=(0,Re.style)({height:"auto",width:"380px",color:"var(--jp-ui-font-color1)!important",borderRadius:"3px!important",backgroundColor:"var(--jp-layout-color1)!important"}),Ws=(0,Re.style)({position:"absolute",top:"10px",right:"12px",height:"30px",width:"30px",padding:0,border:"none",borderRadius:"50%",backgroundColor:"var(--jp-layout-color1)",$nest:{svg:{fill:"var(--jp-ui-font-color1)"},"&:hover":{backgroundColor:"var(--jp-border-color2)"},"&:active":{backgroundColor:"var(--jp-border-color2)"}}}),Vs=(0,Re.style)({boxSizing:"border-box",position:"relative",padding:"15px",borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)"}),$s=(0,Re.style)({fontWeight:700}),Zs=(0,Re.style)({padding:"15px",$nest:{"> p":{marginBottom:"7px"}}}),Ks=(0,Re.style)({padding:"15px!important",borderTop:"var(--jp-border-width) solid var(--jp-border-color2)"}),qs=(0,Re.style)({boxSizing:"border-box",width:"9em",height:"2em",color:"white",fontSize:"var(--jp-ui-font-size1)",cursor:"pointer",border:"0",borderRadius:"3px",$nest:{"&:disabled":{cursor:"default"}}}),Xs=(0,Re.style)({backgroundColor:"var(--md-grey-500)",$nest:{"&:hover":{backgroundColor:"var(--md-grey-600)"},"&:active":{backgroundColor:"var(--md-grey-700)"}}}),Ys=(0,Re.style)({backgroundColor:"var(--md-blue-500)",$nest:{"&:hover":{backgroundColor:"var(--md-blue-600)"},"&:active":{backgroundColor:"var(--md-blue-700)"},"&:disabled":{color:"var(--jp-ui-inverse-font-color0)",backgroundColor:"var(--jp-layout-color3)"},"&:disabled:hover":{backgroundColor:"var(--jp-layout-color3)"},"&:disabled:active":{backgroundColor:"var(--jp-layout-color3)"}}}),Js=(0,Re.style)({display:"flex",flexWrap:"wrap",marginTop:"auto",padding:0,alignItems:"flex-start",backgroundColor:"var(--jp-layout-color1)"}),Qs=(0,Re.style)({width:"100%",height:"1.5em",marginBottom:"1em",padding:"var(--jp-code-padding)",outline:"none",overflowX:"auto",color:"var(--jp-ui-font-color1)",fontSize:"var(--jp-ui-font-size1)",fontWeight:300,backgroundColor:"var(--jp-layout-color1)",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",$nest:{"&:active":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&:focus":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"}}}),ei=(0,Re.style)({width:"100%",marginBottom:"1em",padding:"var(--jp-code-padding)",outline:"none",overflowX:"auto",resize:"none",color:"var(--jp-ui-font-color1)",fontSize:"var(--jp-ui-font-size1)",fontWeight:300,backgroundColor:"var(--jp-layout-color1)",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",$nest:{"&:focus":{outline:"none",border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&:active":{outline:"none",border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&::placeholder":{color:"var(--jp-ui-font-color3)"},"&::-webkit-input-placeholder":{color:"var(--jp-ui-font-color3)"},"&::-moz-placeholder":{color:"var(--jp-ui-font-color3)"},"&::-ms-input-placeholder":{color:"var(--jp-ui-font-color3)"}}});class ti extends _.Component{constructor(e){super(e),this._onSummaryChange=e=>{this.setState({summary:e.target.value})},this._onDescriptionChange=e=>{this.setState({description:e.target.value})},this._onClick=e=>{e.stopPropagation()},this._onClose=e=>{e.stopPropagation(),this.props.onClose(),this._reset()},this._onSubmit=async()=>{this.setState({disabled:!0}),"reset"===this.props.action?this._resetCommit(this.props.commit.commit):this._revertCommit(this.props.commit.commit),this._reset(),this.props.onClose()},this.state={summary:"",description:"",disabled:!1}}render(){const e=this.props.commit.commit.slice(0,7),t="revert"===this.props.action;return _.createElement(zs.Z,{classes:{paper:Gs},open:this.props.open,onClick:this._onClick,onClose:this._onClose},_.createElement("div",{className:Vs},_.createElement("p",{className:$s},t?this.props.trans.__("Revert Changes"):this.props.trans.__("Reset Changes")),_.createElement("button",{className:Ws},_.createElement(Us.Z,{titleAccess:this.props.trans.__("Close this dialog"),fontSize:"small",onClick:this._onClose}))),_.createElement("div",{className:Zs},_.createElement("p",null,t?this.props.trans.__("These changes will be reverted. Only commit if you're sure you're okay losing these changes."):this.props.trans.__("All changes after commit %1 will be gone forever (hard reset). Are you sure?",e)),t?_.createElement("div",{className:Js},_.createElement("input",{className:Qs,type:"text",placeholder:this._defaultSummary(),title:this.props.trans.__("Enter a commit message summary (a single line, preferably less than 50 characters)"),value:this.state.summary,onChange:this._onSummaryChange}),_.createElement(ps(),{className:ei,minRows:5,placeholder:this._defaultDescription(),title:this.props.trans.__("Enter a commit message description"),value:this.state.description,onChange:this._onDescriptionChange})):null),_.createElement(Hs.Z,{className:Ks},_.createElement("input",{disabled:this.state.disabled,className:(0,Re.classes)(qs,Xs),type:"button",title:this.props.trans.__("Cancel changes"),value:"Cancel",onClick:this._onClose}),_.createElement("input",{disabled:this.state.disabled,className:(0,Re.classes)(qs,Ys),type:"button",title:this.props.trans.__("Submit changes"),value:"Submit",onClick:this._onSubmit})))}async _resetCommit(e){this.props.logger.log({level:fe.RUNNING,message:this.props.trans.__("Discarding changes...")});try{await this.props.model.resetToCommit(e),this.props.logger.log({level:fe.SUCCESS,message:this.props.trans.__("Successfully discarded changes.")})}catch(t){this.props.logger.log({level:fe.ERROR,message:this.props.trans.__("Failed to discard changes."),error:new Error(`Failed to discard changes after ${e.slice(0,7)}: ${t}`)})}}async _revertCommit(e){this.props.logger.log({level:fe.RUNNING,message:this.props.trans.__("Reverting changes...")});try{await this.props.model.revertCommit(this._commitMessage(),e),this.props.logger.log({level:fe.SUCCESS,message:this.props.trans.__("Successfully reverted changes.")})}catch(t){this.props.logger.log({level:fe.ERROR,message:this.props.trans.__("Failed to revert changes."),error:new Error(`Failed to revert ${e.slice(0,7)}: ${t}`)})}}_defaultSummary(){const e=this.props.commit.commit_msg.split("\n")[0];return this.props.trans.__("Revert '%1'",e)}_defaultDescription(){return this.props.trans.__("This reverts commit %1",this.props.commit.commit)}_commitMessage(){return(this.state.summary||this._defaultSummary())+"\n\n"+(this.state.description||this._defaultDescription())+"\n"}_reset(){this.setState({summary:"",description:"",disabled:!1})}}class si extends _.Component{constructor(e){super(e),this._renderFile=e=>{const{data:t,index:s,style:i}=e,r=t[s],n=r.modified_file_path,o=!!xe(n)||!r.is_binary;return _.createElement("li",{className:Ts,onClick:this._onDiffClickFactory(n,o),style:i,title:n},_.createElement(ot,{filepath:n,filetype:r.type}),o?_.createElement(qe,{icon:Ae,title:this.props.trans.__("View file changes")}):null)},this._onRevertClick=e=>{e.stopPropagation(),this.setState({resetRevertDialog:!0,resetRevertAction:"revert"})},this._onResetClick=e=>{e.stopPropagation(),this.setState({resetRevertDialog:!0,resetRevertAction:"reset"})},this._onResetRevertDialogClose=()=>{this.setState({resetRevertDialog:!1})},this.state={info:"",numFiles:"",insertions:"",deletions:"",modifiedFiles:[],loadingState:"loading",resetRevertDialog:!1,resetRevertAction:"reset"}}async componentDidMount(){try{const e=await this.props.model.detailedLog(this.props.commit.commit);this.setState({info:e.modified_file_note,numFiles:e.modified_files_count,insertions:e.number_of_insertions,deletions:e.number_of_deletions,modifiedFiles:e.modified_files,loadingState:"success"})}catch(e){return console.error(`Error while getting detailed log for commit ${this.props.commit.commit} and path ${this.props.model.pathRepository}`,e),void this.setState({loadingState:"error"})}}render(){return"loading"===this.state.loadingState?_.createElement("div",null,"..."):"error"===this.state.loadingState?_.createElement("div",null,this.props.trans.__("Error loading commit data")):_.createElement("div",null,_.createElement("div",{className:js},_.createElement("div",{className:Ns},_.createElement("span",{title:this.props.trans.__("# Files Changed")},_.createElement(g.fileIcon.react,{className:Ms,tag:"span"}),this.state.numFiles),_.createElement("span",{title:this.props.trans.__("# Insertions")},_.createElement(He.react,{className:(0,Re.classes)(Ms,Ps),tag:"span"}),this.state.insertions),_.createElement("span",{title:this.props.trans.__("# Deletions")},_.createElement(Oe.react,{className:(0,Re.classes)(Ms,Os),tag:"span"}),this.state.deletions))),_.createElement("div",{className:Bs},_.createElement("div",{className:Is},this.props.trans.__("Changed"),_.createElement(qe,{className:As,icon:ze,title:this.props.trans.__("Revert changes introduced by this commit"),onClick:this._onRevertClick}),_.createElement(qe,{className:As,icon:$e,title:this.props.trans.__("Discard changes introduced *after* this commit (hard reset)"),onClick:this._onResetClick}),_.createElement(wt.Consumer,null,(e=>_.createElement(ti,{open:this.state.resetRevertDialog,action:this.state.resetRevertAction,model:this.props.model,logger:e,commit:this.props.commit,onClose:this._onResetRevertDialogClose,trans:this.props.trans})))),this.state.modifiedFiles.length>0&&_.createElement(ht.FixedSizeList,{className:Ls,height:24*Math.min(20,this.state.modifiedFiles.length),innerElementType:"ul",itemCount:this.state.modifiedFiles.length,itemData:this.state.modifiedFiles,itemKey:(e,t)=>t[e].modified_file_path,itemSize:24,style:{overflowX:"hidden"},width:"auto"},this._renderFile)))}_onDiffClickFactory(e,t){const s=this;return t?async function(i){i.stopPropagation();try{s.props.commands.execute(_e.gitFileDiff,{files:[{filePath:e,isText:t,context:{previousRef:s.props.commit.pre_commit,currentRef:s.props.commit.commit}}]})}catch(t){console.error(`Failed to open diff view for ${e}.\n${t}`)}}:function(e){e.stopPropagation()}}}class ii extends _.Component{constructor(e){super(e),this._onCommitClick=()=>{this.setState({expanded:!this.state.expanded})},this.state={expanded:!1}}render(){return _.createElement("li",{className:(0,Re.classes)(ys,this.state.expanded?Fs:null),onClick:this._onCommitClick},_.createElement("div",{className:vs},_.createElement("span",{className:ws},this.props.commit.author),_.createElement("span",{className:ws},this.props.commit.commit.slice(0,7)),_.createElement("span",{className:ws},this.props.commit.date),this.state.expanded?_.createElement(g.caretUpIcon.react,{className:Ds,tag:"span"}):_.createElement(g.caretDownIcon.react,{className:Ds,tag:"span"})),_.createElement("div",{className:Cs},this._renderBranches()),_.createElement("div",{className:Rs},this.props.commit.commit_msg,this.state.expanded&&_.createElement(si,{commit:this.props.commit,model:this.props.model,commands:this.props.commands,trans:this.props.trans})))}_renderBranches(){const e=this.props.commit.commit,t=[];for(let s=0;s<this.props.branches.length;s++){const i=this.props.branches[s];i.top_commit&&i.top_commit===e&&t.push(i)}return t.map(this._renderBranch,this)}_renderBranch(e){return _.createElement(_.Fragment,{key:e.name},e.is_current_branch&&_.createElement("span",{className:(0,Re.classes)(ks,Ss)},"working"),_.createElement("span",{className:(0,Re.classes)(ks,e.is_remote_branch?xs:Es)},e.name))}}const ri=e=>_.createElement("ol",{className:bs},e.commits.map((t=>_.createElement(ii,{key:t.commit,commit:t,branches:e.branches,model:e.model,commands:e.commands,trans:e.trans})))),ni=(0,Re.style)({display:"flex",flexDirection:"column",backgroundColor:"var(--jp-layout-color1)"}),oi=(0,Re.style)({display:"flex",flexDirection:"row",flexWrap:"wrap",minHeight:"35px",lineHeight:"var(--jp-private-running-item-height)",backgroundColor:"var(--jp-layout-color1)",borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)"}),ai=(0,Re.style)({background:"var(--jp-layout-color1)"}),li=(0,Re.style)({boxSizing:"border-box",display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",minHeight:"50px",padding:"4px 11px 4px 11px",fontSize:"var(--jp-ui-font-size1)",lineHeight:"1.5em",color:"var(--jp-ui-font-color1)",textAlign:"left",border:"none",borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:0,background:"var(--jp-layout-color1)"}),ci=(0,Re.style)({$nest:{"&:hover":{backgroundColor:"var(--jp-layout-color2)"},"&:active":{backgroundColor:"var(--jp-layout-color3)"}}}),hi=(0,Re.style)({width:"16px",height:"16px",margin:"auto 8px auto 0"}),di=(0,Re.style)({flexBasis:0,flexGrow:1,marginTop:"auto",marginBottom:"auto",marginRight:"auto"}),pi=(0,Re.style)({}),gi=(0,Re.style)({marginBottom:"auto",fontWeight:700}),mi=(0,Re.style)({boxSizing:"border-box",height:"24px",width:"var(--jp-private-running-button-width) !important",margin:"auto 0 auto 0",padding:"0px 6px !important",border:"none",outline:"none",$nest:{"&:disabled":{opacity:.4,background:"none",cursor:"not-allowed"},"&:hover":{backgroundColor:"var(--jp-layout-color2)"},"&:active":{backgroundColor:"var(--jp-layout-color3)"},"& span":{margin:"auto",width:"16px"}}}),ui=(0,Re.style)({flex:"1 1 auto"}),fi=(0,Re.style)({$nest:{"& > .MuiBadge-badge":{top:12,right:15,backgroundColor:"var(--jp-warn-color1)"}}});var _i=s(2822),bi=s(998);const yi=(0,Re.style)({flex:"1 1 auto",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),vi=(0,Re.style)({marginTop:"6px",marginBottom:"0",borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)"}),wi=(0,Re.style)({padding:"4px 11px 4px",display:"flex"}),Ci=(0,Re.style)({flex:"1 1 auto",boxSizing:"border-box",display:"inline-block",position:"relative",fontSize:"var(--jp-ui-font-size1)"}),ki=(0,Re.style)({boxSizing:"border-box",width:"100%",height:"2em",padding:"1px 18px 2px 7px",color:"var(--jp-ui-font-color1)",fontSize:"var(--jp-ui-font-size1)",fontWeight:300,backgroundColor:"var(--jp-layout-color1)",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",$nest:{"&:active":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&:focus":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"}}}),xi=(0,Re.style)({position:"absolute",right:"5px",top:"0.6em",height:"1.1em",width:"1.1em",padding:0,backgroundColor:"var(--jp-inverse-layout-color4)",border:"none",borderRadius:"50%",$nest:{svg:{width:"0.5em!important",height:"0.5em!important",fill:"var(--jp-ui-inverse-font-color0)"},"&:hover":{backgroundColor:"var(--jp-inverse-layout-color3)"},"&:active":{backgroundColor:"var(--jp-inverse-layout-color2)"}}}),Ei=(0,Re.style)({boxSizing:"border-box",width:"7.7em",height:"2em",flex:"0 0 auto",marginLeft:"5px",color:"white",fontSize:"var(--jp-ui-font-size1)",backgroundColor:"var(--md-blue-500)",border:"0",borderRadius:"3px",$nest:{"&:hover":{backgroundColor:"var(--md-blue-600)"},"&:active":{backgroundColor:"var(--md-blue-700)"}}}),Si=(0,Re.style)({padding:"4px 11px!important"},Ne),Fi=(0,Re.style)({color:"white!important",backgroundColor:"var(--jp-brand-color1)!important",$nest:{"& .jp-icon-selectable[fill]":{fill:"white"}}}),Ri=(0,Re.style)({width:"16px",height:"16px",marginRight:"4px"}),Di=(0,Re.style)({minHeight:"460px",width:"400px",color:"var(--jp-ui-font-color1)!important",borderRadius:"3px!important",backgroundColor:"var(--jp-layout-color1)!important"}),ji=(0,Re.style)({position:"absolute",top:"10px",right:"12px",height:"30px",width:"30px",padding:0,border:"none",borderRadius:"50%",backgroundColor:"var(--jp-layout-color1)",$nest:{svg:{fill:"var(--jp-ui-font-color1)"},"&:hover":{backgroundColor:"var(--jp-border-color2)"},"&:active":{backgroundColor:"var(--jp-border-color2)"}}}),Ni=(0,Re.style)({boxSizing:"border-box",position:"relative",padding:"15px",borderBottom:"var(--jp-border-width) solid var(--jp-border-color2)"}),Bi=(0,Re.style)({fontWeight:700}),Ii=(0,Re.style)({padding:"15px",$nest:{"> p":{marginBottom:"7px"}}}),Ti=(0,Re.style)({boxSizing:"border-box",width:"100%",height:"2em",marginBottom:"16px",padding:"1px 18px 2px 7px",color:"var(--jp-ui-font-color1)",fontSize:"var(--jp-ui-font-size1)",fontWeight:300,backgroundColor:"var(--jp-layout-color1)",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",$nest:{"&:active":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&:focus":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"}}}),Mi=(0,Re.style)({padding:0,paddingBottom:"4px"}),Pi=(0,Re.style)({boxSizing:"border-box",display:"inline-block",position:"relative",width:"100%",marginRight:"11px",fontSize:"var(--jp-ui-font-size1)"}),Oi=(0,Re.style)({boxSizing:"border-box",width:"100%",height:"2em",padding:"1px 18px 2px 7px",color:"var(--jp-ui-font-color1)",fontSize:"var(--jp-ui-font-size1)",fontWeight:300,backgroundColor:"var(--jp-layout-color1)",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",$nest:{"&:active":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"},"&:focus":{border:"var(--jp-border-width) solid var(--jp-brand-color1)"}}}),Li=(0,Re.style)({position:"absolute",right:"5px",top:"0.6em",height:"1.1em",width:"1.1em",padding:0,backgroundColor:"var(--jp-inverse-layout-color4)",border:"none",borderRadius:"50%",$nest:{svg:{width:"0.5em!important",height:"0.5em!important",fill:"var(--jp-ui-inverse-font-color0)"},"&:hover":{backgroundColor:"var(--jp-inverse-layout-color3)"},"&:active":{backgroundColor:"var(--jp-inverse-layout-color2)"}}}),Ai=(0,Re.style)({boxSizing:"border-box",display:"block",border:"var(--jp-border-width) solid var(--jp-border-color2)",borderRadius:"3px",paddingTop:0,paddingBottom:0}),zi=(0,Re.style)({flexDirection:"row",flexWrap:"wrap",width:"100%",padding:"4px 11px 4px 11px!important",fontSize:"var(--jp-ui-font-size1)",lineHeight:"1.5em"}),Hi=(0,Re.style)({color:"white!important",backgroundColor:"var(--jp-brand-color1)!important",$nest:{"& .jp-icon-selectable[fill]":{fill:"white"}}}),Ui=(0,Re.style)({flexBasis:0,flexGrow:1,marginTop:"auto",marginBottom:"auto",marginRight:"auto"}),Gi=(0,Re.style)({marginBottom:"auto"}),Wi=(0,Re.style)({width:"16px",height:"16px",margin:"auto 8px auto 0"}),Vi=(0,Re.style)({}),$i=(0,Re.style)({fontWeight:700}),Zi=(0,Re.style)({color:"#ff0000"}),Ki=(0,Re.style)({padding:"15px!important",borderTop:"var(--jp-border-width) solid var(--jp-border-color2)"}),qi=(0,Re.style)({boxSizing:"border-box",width:"9em",height:"2em",color:"white",fontSize:"var(--jp-ui-font-size1)",border:"0",borderRadius:"3px"}),Xi=(0,Re.style)({backgroundColor:"var(--md-grey-500)",$nest:{"&:hover":{backgroundColor:"var(--md-grey-600)"},"&:active":{backgroundColor:"var(--md-grey-700)"}}}),Yi=(0,Re.style)({backgroundColor:"var(--md-blue-500)",$nest:{"&:hover":{backgroundColor:"var(--md-blue-600)"},"&:active":{backgroundColor:"var(--md-blue-700)"},"&:disabled":{cursor:"default",color:"var(--jp-ui-inverse-font-color0)",backgroundColor:"var(--jp-layout-color3)"},"&:disabled:hover":{backgroundColor:"var(--jp-layout-color3)"},"&:disabled:active":{backgroundColor:"var(--jp-layout-color3)"}}});class Ji extends _.Component{constructor(e){super(e),this._renderItem=e=>{const{data:t,index:s,style:i}=e,r=t[s],n=r.name===this.props.currentBranch;let o,a;return n&&(o=!0,a="The current branch. Pick this if you want to build on work done in this branch."),_.createElement(bi.Z,{button:!0,title:this.props.trans.__("Create a new branch based on: %1",r.name),className:(0,Re.classes)(zi,n?Hi:null),onClick:this._onBranchClickFactory(r.name),style:i},_.createElement(Me.react,{className:Wi,tag:"span"}),_.createElement("div",{className:Ui},_.createElement("p",{className:(0,Re.classes)(Vi,o?$i:null)},r.name),a?_.createElement("p",{className:Gi},this.props.trans.__(a)):null))},this._onClose=()=>{this.props.onClose(),this.setState({name:"",filter:"",error:""})},this._onFilterChange=e=>{this._branchList.current.resetAfterIndex(0),this.setState({filter:e.target.value})},this._resetFilter=()=>{this._branchList.current.resetAfterIndex(0),this.setState({filter:""})},this._onNameChange=e=>{this.setState({name:e.target.value,error:""})},this._onCreate=()=>{this._createBranch(this.state.name)},this._branchList=_.createRef(),this.state={name:"",base:e.currentBranch||"",filter:"",error:""}}render(){return _.createElement(zs.Z,{classes:{paper:Di},open:this.props.open,onClose:this._onClose},_.createElement("div",{className:Ni},_.createElement("p",{className:Bi},this.props.trans.__("Create a Branch")),_.createElement("button",{className:ji},_.createElement(Us.Z,{titleAccess:this.props.trans.__("Close this dialog"),fontSize:"small",onClick:this._onClose}))),_.createElement("div",{className:Ii},this.state.error?_.createElement("p",{className:Zi},this.state.error):null,_.createElement("p",null,this.props.trans.__("Name")),_.createElement("input",{className:Ti,type:"text",onChange:this._onNameChange,value:this.state.name,placeholder:"",title:this.props.trans.__("Enter a branch name")}),_.createElement("p",null,this.props.trans.__("Create branch based on...")),_.createElement("div",{className:Mi},_.createElement("div",{className:Pi},_.createElement("input",{className:Oi,type:"text",onChange:this._onFilterChange,value:this.state.filter,placeholder:this.props.trans.__("Filter"),title:this.props.trans.__("Filter branch menu")}),this.state.filter?_.createElement("button",{className:Li},_.createElement(Us.Z,{titleAccess:this.props.trans.__("Clear the current filter"),fontSize:"small",onClick:this._resetFilter})):null)),this._renderItems()),_.createElement(Hs.Z,{className:Ki},_.createElement("input",{className:(0,Re.classes)(qi,Xi),type:"button",title:this.props.trans.__("Close this dialog without creating a new branch"),value:this.props.trans.__("Cancel"),onClick:this._onClose}),_.createElement("input",{className:(0,Re.classes)(qi,Yi),type:"button",title:this.props.trans.__("Create a new branch"),value:this.props.trans.__("Create Branch"),onClick:this._onCreate,disabled:""===this.state.name||""!==this.state.error})))}_renderItems(){const e=this.props.currentBranch,t=this.state.filter,s=this.props.branches.filter((e=>!t||e.name.includes(t))).slice().sort((function(t,s){return t.name===e?-1:s.name===e?1:"master"===t.name?-1:"master"===s.name?1:"main"===t.name?-1:"main"===s.name?1:0}));return _.createElement(ht.VariableSizeList,{className:Ai,height:200,estimatedItemSize:27.5,itemCount:s.length,itemData:s,itemKey:(e,t)=>t[e].name,itemSize:e=>s[e].name===this.props.currentBranch?66.5:27.5,ref:this._branchList,style:{overflowX:"hidden"},width:"auto"},this._renderItem)}_onBranchClickFactory(e){const t=this;return function(){t.setState({base:e})}}async _createBranch(e){const t={newBranch:!0,branchname:e};this.props.logger.log({level:fe.RUNNING,message:this.props.trans.__("Creating branch...")});try{await this.props.model.checkout(t)}catch(e){return this.setState({error:e.message.replace(/^fatal:/,"")}),void this.props.logger.log({level:fe.ERROR,message:this.props.trans.__("Failed to create branch.")})}this.props.logger.log({level:fe.SUCCESS,message:this.props.trans.__("Branch created.")}),this.props.onClose(),this._branchList.current.resetAfterIndex(0),this.setState({name:"",filter:""})}}function Qi(e){return _.createElement(bi.Z,{key:e},e)}class er extends _.Component{constructor(e){super(e),this.CHANGES_ERR_MSG=this.props.trans.__("The current branch contains files with uncommitted changes. Please commit or discard these changes before switching to or creating another branch."),this._renderItem=e=>{const{data:t,index:s,style:i}=e,r=t[s],n=r.name===this.props.currentBranch;return _.createElement(bi.Z,{button:!0,title:this.props.trans.__("Switch to branch: %1",r.name),className:(0,Re.classes)(Si,n?Fi:null),onClick:this._onBranchClickFactory(r.name),style:i},_.createElement(Me.react,{className:Ri,tag:"span"}),_.createElement("span",{className:yi},r.name),!r.is_remote_branch&&!n&&_.createElement(qe,{className:je,icon:Ke,title:this.props.trans.__("Delete this branch locally"),onClick:e=>{e.stopPropagation(),this._onDeleteBranch(r.name)}}))},this._onFilterChange=e=>{this.setState({filter:e.target.value})},this._resetFilter=()=>{this.setState({filter:""})},this._onDeleteBranch=async e=>{if((await(0,r.showDialog)({title:this.props.trans.__("Delete branch"),body:_.createElement("p",null,this.props.trans.__("Are you sure you want to permanently delete the branch "),_.createElement("b",null,e),"?",_.createElement("br",null),this.props.trans.__("This action cannot be undone.")),buttons:[r.Dialog.cancelButton({label:this.props.trans.__("Cancel")}),r.Dialog.warnButton({label:this.props.trans.__("Delete")})]})).button.accept)try{await this.props.model.deleteBranch(e),await this.props.model.refreshBranch()}catch(t){console.error(`Failed to delete branch ${e}`,t)}},this._onNewBranchClick=()=>{this.props.branching?this.setState({branchDialog:!0}):(0,r.showErrorMessage)(this.props.trans.__("Creating a new branch is disabled"),this.CHANGES_ERR_MSG)},this._onNewBranchDialogClose=()=>{this.setState({branchDialog:!1})},this.state={filter:"",branchDialog:!1}}render(){return _.createElement("div",{className:vi},this._renderFilter(),this._renderBranchList(),this._renderNewBranchDialog())}_renderFilter(){return _.createElement("div",{className:wi},_.createElement("div",{className:Ci},_.createElement("input",{className:ki,type:"text",onChange:this._onFilterChange,value:this.state.filter,placeholder:this.props.trans.__("Filter"),title:this.props.trans.__("Filter branch menu")}),this.state.filter?_.createElement("button",{className:xi},_.createElement(Us.Z,{titleAccess:this.props.trans.__("Clear the current filter"),fontSize:"small",onClick:this._resetFilter})):null),_.createElement("input",{className:Ei,type:"button",title:this.props.trans.__("Create a new branch"),value:this.props.trans.__("New Branch"),onClick:this._onNewBranchClick}))}_renderBranchList(){const e=this.state.filter,t=this.props.branches.filter((t=>!e||t.name.includes(e)));return _.createElement(ht.FixedSizeList,{height:Math.min(Math.max(150,24.8*t.length),400),itemCount:t.length,itemData:t,itemKey:(e,t)=>t[e].name,itemSize:24.8,style:{overflowX:"hidden",paddingTop:0,paddingBottom:0},width:"auto"},this._renderItem)}_renderNewBranchDialog(){return _.createElement(Ji,{currentBranch:this.props.currentBranch,branches:this.props.branches,logger:this.props.logger,open:this.state.branchDialog,model:this.props.model,onClose:this._onNewBranchDialogClose,trans:this.props.trans})}_onBranchClickFactory(e){const t=this;return async function(){if(!t.props.branching)return void(0,r.showErrorMessage)(t.props.trans.__("Switching branches is disabled"),t.CHANGES_ERR_MSG);const s={branchname:e};t.props.logger.log({level:fe.RUNNING,message:t.props.trans.__("Switching branch...")});try{await t.props.model.checkout(s)}catch(e){return function(e,t,s){e.message.includes("following files would be overwritten")?(t.log({message:"",level:fe.INFO}),(0,r.showDialog)({title:s.__("Unable to switch branch"),body:_.createElement(_.Fragment,null,_.createElement("p",null,s.__("Your changes to the following files would be overwritten by switching:")),_.createElement(_i.Z,null,e.message.split("\n").slice(1,-3).map(Qi)),_.createElement("span",null,s.__("Please commit, stash, or discard your changes before you switch branches."))),buttons:[r.Dialog.okButton({label:s.__("Dismiss")})]})):t.log({level:fe.ERROR,message:s.__("Failed to switch branch."),error:e})}(e,t.props.logger,t.props.trans)}t.props.logger.log({level:fe.SUCCESS,message:t.props.trans.__("Switched branch.")})}}}function tr(e){return _.createElement(bi.Z,{key:e},e)}class sr extends _.Component{constructor(e){super(e),this._renderItem=e=>{const{data:t,index:s,style:i}=e,r=t[s];return _.createElement(bi.Z,{button:!0,title:this.props.trans.__("Checkout to tag: %1",r),className:Si,onClick:this._onTagClickFactory(r),style:i},_.createElement(Ze.react,{className:Ri,tag:"span"}),_.createElement("span",{className:yi},r))},this._onFilterChange=e=>{this.setState({filter:e.target.value})},this._resetFilter=()=>{this.setState({filter:""})},this.state={filter:"",tags:[]}}componentDidMount(){this.props.model.tags().then((e=>{this.setState({tags:e.tags})})).catch((e=>{console.error(e),this.setState({tags:[]}),(0,r.showErrorMessage)(this.props.trans.__("Fail to get the tags."),e)}))}render(){return _.createElement("div",{className:vi},this._renderFilter(),this._renderTagList())}_renderFilter(){return _.createElement("div",{className:wi},_.createElement("div",{className:Ci},_.createElement("input",{className:ki,type:"text",onChange:this._onFilterChange,value:this.state.filter,placeholder:this.props.trans.__("Filter"),title:this.props.trans.__("Filter branch menu")}),this.state.filter?_.createElement("button",{className:xi},_.createElement(Us.Z,{titleAccess:this.props.trans.__("Clear the current filter"),fontSize:"small",onClick:this._resetFilter})):null))}_renderTagList(){const e=this.state.filter,t=this.state.tags.filter((t=>!e||t.includes(e)));return _.createElement(ht.FixedSizeList,{height:Math.min(Math.max(150,24.8*t.length),400),itemCount:t.length,itemData:t,itemKey:(e,t)=>t[e],itemSize:24.8,style:{overflowX:"hidden",paddingTop:0,paddingBottom:0},width:"auto"},this._renderItem)}_onTagClickFactory(e){const t=this;return async function(){if(t.props.branching){t.props.logger.log({level:fe.RUNNING,message:t.props.trans.__("Checking tag out...")});try{await t.props.model.checkoutTag(e)}catch(e){return function(e,t,s){e.message.includes("following files would be overwritten")?(t.log({message:"",level:fe.INFO}),(0,r.showDialog)({title:s.__("Unable to checkout tag"),body:_.createElement(_.Fragment,null,_.createElement("p",null,s.__("Your changes to the following files would be overwritten by switching:")),_.createElement(_i.Z,null,e.message.split("\n").slice(1,-3).map(tr)),_.createElement("span",null,s.__("Please commit, stash, or discard your changes before you checkout tags."))),buttons:[r.Dialog.okButton({label:s.__("Dismiss")})]})):t.log({level:fe.ERROR,message:s.__("Failed to checkout tag."),error:e})}(e,t.props.logger,t.props.trans)}t.props.logger.log({level:fe.SUCCESS,message:t.props.trans.__("Tag checkout.")})}else(0,r.showErrorMessage)(t.props.trans.__("Checkout tags is disabled"),t.props.trans.__("The repository contains files with uncommitted changes. Please commit or discard these changes before switching to a tag."))}}}class ir extends _.Component{constructor(e){super(e),this._onPullClick=async()=>{await this.props.commands.execute(be.gitPull)},this._onPushClick=async()=>{await this.props.commands.execute(be.gitPush)},this._onBranchClick=()=>{this.setState({branchMenu:!this.state.branchMenu})},this._onRefreshClick=async()=>{this.props.logger.log({level:fe.RUNNING,message:this.props.trans.__("Refreshing...")});try{await this.props.model.refresh(),this.props.logger.log({level:fe.SUCCESS,message:this.props.trans.__("Successfully refreshed.")})}catch(e){console.error(e),this.props.logger.log({level:fe.ERROR,message:this.props.trans.__("Failed to refresh."),error:e})}},this.state={branchMenu:!1,tab:0}}render(){return _.createElement("div",{className:ni},this._renderTopNav(),this._renderRepoMenu(),this._renderBranchMenu())}_renderTopNav(){var e;const t=this.props.branches.filter((e=>e.is_current_branch)),s=this.props.branches.some((e=>e.is_remote_branch)),i=null!==(null===(e=t[0])||void 0===e?void 0:e.upstream);return _.createElement("div",{className:oi},_.createElement("span",{className:ui}),_.createElement(zt.Badge,{className:fi,variant:"dot",invisible:!s||0===this.props.nCommitsBehind,"data-test-id":"pull-badge"},_.createElement(qe,{className:mi,disabled:!s,icon:Ge,onClick:s?this._onPullClick:void 0,title:s?this.props.trans.__("Pull latest changes")+(this.props.nCommitsBehind>0?this.props.trans.__(" (behind by %1 commits)",this.props.nCommitsBehind):""):this.props.trans.__("No remote repository defined")})),_.createElement(zt.Badge,{className:fi,variant:"dot",invisible:!s||0===this.props.nCommitsAhead&&i,"data-test-id":"push-badge"},_.createElement(qe,{className:mi,disabled:!s,icon:We,onClick:s?this._onPushClick:void 0,title:s?i?this.props.trans.__("Push committed changes")+(this.props.nCommitsAhead>0?this.props.trans.__(" (ahead by %1 commits)",this.props.nCommitsAhead):""):this.props.trans.__("Publish branch"):this.props.trans.__("No remote repository defined")})),_.createElement(qe,{className:mi,icon:g.refreshIcon,onClick:this._onRefreshClick,title:this.props.trans.__("Refresh the repository to detect local and remote changes")}))}_renderRepoMenu(){return _.createElement("div",{className:ai},_.createElement("button",{disabled:!0,className:li,title:this.props.trans.__("Current repository: %1",this.props.repository)},_.createElement(Le.react,{className:hi}),_.createElement("div",{className:di},_.createElement("p",{className:pi}," ",this.props.trans.__("Current Repository")," "),_.createElement("p",{className:gi},p.PathExt.basename(this.props.repository)))))}_renderBranchMenu(){return this.props.model.pathRepository?_.createElement("div",{className:ai},_.createElement("button",{className:(0,Re.classes)(li,ci),title:this.props.trans.__("Manage branches and tags"),onClick:this._onBranchClick},_.createElement(Me.react,{className:hi}),_.createElement("div",{className:di},_.createElement("p",{className:pi},this.props.trans.__("Current Branch")),_.createElement("p",{className:gi},this.props.currentBranch||"")),this.state.branchMenu?_.createElement(g.caretUpIcon.react,{className:hi}):_.createElement(g.caretDownIcon.react,{className:hi})),this.state.branchMenu?this._renderTabs():null):null}_renderTabs(){return _.createElement(_.Fragment,null,_.createElement(zt.Tabs,{classes:{root:ns,indicator:ls},value:this.state.tab,onChange:(e,t)=>{this.setState({tab:t})}},_.createElement(zt.Tab,{classes:{root:os,selected:as},title:this.props.trans.__("View branches"),label:this.props.trans.__("Branches"),disableFocusRipple:!0,disableRipple:!0}),_.createElement(zt.Tab,{classes:{root:os,selected:as},title:this.props.trans.__("View tags"),label:this.props.trans.__("Tags"),disableFocusRipple:!0,disableRipple:!0})),0===this.state.tab?this._renderBranches():this._renderTags())}_renderBranches(){return _.createElement(er,{currentBranch:this.props.currentBranch||"",branches:this.props.branches,branching:this.props.branching,logger:this.props.logger,model:this.props.model,trans:this.props.trans})}_renderTags(){return _.createElement(sr,{logger:this.props.logger,model:this.props.model,branching:this.props.branching,trans:this.props.trans})}}class rr extends _.Component{constructor(e){super(e),this.refreshBranch=async()=>{const{currentBranch:e}=this.props.model;this.setState({branches:this.props.model.branches,currentBranch:e?e.name:"master"})},this.refreshHistory=async()=>{if(null!==this.props.model.pathRepository){const e=await this.props.model.log(this.props.settings.composite.historyCount);let t=new Array;0===e.code&&(t=e.commits),this.setState({pastCommits:t})}},this.refreshView=async()=>{null!==this.props.model.pathRepository&&(await this.refreshBranch(),await this.refreshHistory())},this.commitMarkedFiles=async e=>{this.props.logger.log({level:fe.RUNNING,message:this.props.trans.__("Staging files...")}),await this.props.model.reset(),await this.props.model.add(...this._markedFiles.map((e=>e.to))),await this.commitStagedFiles(e)},this.commitStagedFiles=async e=>{if(!e)return;const t={level:fe.ERROR,message:this.props.trans.__("Failed to commit changes.")};try{if(!await this._hasIdentity(this.props.model.pathRepository))return void this.props.logger.log(t);this.props.logger.log({level:fe.RUNNING,message:this.props.trans.__("Committing changes...")}),await this.props.model.commit(e),this.props.logger.log({level:fe.SUCCESS,message:this.props.trans.__("Committed changes.")})}catch(e){console.error(e),this.props.logger.log(Object.assign(Object.assign({},t),{error:e}))}const s=this.props.model.branches.some((e=>e.is_remote_branch));this.props.settings.composite.commitAndPush&&s&&await this.props.commands.execute(be.gitPush)},this._onTabChange=(e,t)=>{1===t&&this.refreshHistory(),this.setState({tab:t})},this._previousRepoPath=null;const{branches:t,currentBranch:s,pathRepository:i}=e.model;this.state={branches:t,currentBranch:s?s.name:"master",files:[],nCommitsAhead:0,nCommitsBehind:0,pastCommits:[],repository:i,tab:0}}componentDidMount(){const{model:e,settings:t}=this.props;e.repositoryChanged.connect(((e,t)=>{this.setState({repository:t.newValue}),this.refreshView()}),this),e.statusChanged.connect((()=>{this.setState({files:e.status.files,nCommitsAhead:e.status.ahead,nCommitsBehind:e.status.behind})}),this),e.headChanged.connect((async()=>{await this.refreshBranch(),1===this.state.tab&&this.refreshHistory()}),this),e.markChanged.connect((()=>this.forceUpdate()),this),t.changed.connect(this.refreshView,this)}componentWillUnmount(){y.Signal.clearData(this)}render(){return _.createElement("div",{className:ss},this.state.repository?_.createElement(_.Fragment,null,this._renderToolbar(),this._renderMain()):this._renderWarning())}_renderToolbar(){const e=Boolean(this.props.settings.composite.disableBranchWithChanges&&(this._hasUnStagedFile()||this._hasStagedFile()));return _.createElement(ir,{currentBranch:this.state.currentBranch,branches:this.state.branches,branching:!e,commands:this.props.commands,logger:this.props.logger,model:this.props.model,nCommitsAhead:this.state.nCommitsAhead,nCommitsBehind:this.state.nCommitsBehind,repository:this.state.repository||"",trans:this.props.trans})}_renderMain(){return _.createElement(_.Fragment,null,this._renderTabs(),1===this.state.tab?this._renderHistory():this._renderChanges())}_renderTabs(){return _.createElement(ts.Z,{classes:{root:ns,indicator:ls},value:this.state.tab,onChange:this._onTabChange},_.createElement(es.Z,{classes:{root:os,selected:as},title:this.props.trans.__("View changed files"),label:this.props.trans.__("Changes"),disableFocusRipple:!0,disableRipple:!0}),_.createElement(es.Z,{classes:{root:os,selected:as},title:this.props.trans.__("View commit history"),label:this.props.trans.__("History"),disableFocusRipple:!0,disableRipple:!0}))}_renderChanges(){const e=this.props.model.branches.some((e=>e.is_remote_branch)),t=this.props.settings.composite.commitAndPush&&e?this.props.trans.__("Commit and Push"):this.props.trans.__("Commit");return _.createElement(_.Fragment,null,_.createElement(yt,{files:this._sortedFiles,model:this.props.model,commands:this.props.commands,settings:this.props.settings,trans:this.props.trans}),this.props.settings.composite.simpleStaging?_.createElement(_s,{commands:this.props.commands,hasFiles:this._markedFiles.length>0,trans:this.props.trans,label:t,onCommit:this.commitMarkedFiles}):_.createElement(_s,{commands:this.props.commands,hasFiles:this._hasStagedFile(),trans:this.props.trans,label:t,onCommit:this.commitStagedFiles}))}_renderHistory(){return _.createElement(ri,{branches:this.state.branches,commits:this.state.pastCommits,model:this.props.model,commands:this.props.commands,trans:this.props.trans})}_renderWarning(){const e=this.props.filebrowser.path,{commands:t}=this.props;return _.createElement(_.Fragment,null,_.createElement("div",{className:is},e?_.createElement(_.Fragment,null,_.createElement("b",{title:e},p.PathExt.basename(e))," ",this.props.trans.__("is not")):this.props.trans.__("You are not currently in"),this.props.trans.__(" a Git repository. To use Git, navigate to a local repository, initialize a repository here, or clone an existing repository.")),_.createElement("button",{className:rs,onClick:()=>t.execute("filebrowser:toggle-main")},this.props.trans.__("Open the FileBrowser")),_.createElement("button",{className:rs,onClick:()=>t.execute(be.gitInit)},this.props.trans.__("Initialize a Repository")),_.createElement("button",{className:rs,onClick:async()=>{await t.execute(be.gitClone),await t.execute("filebrowser:toggle-main")}},this.props.trans.__("Clone a Repository")))}async _hasIdentity(e){if(e!==this._previousRepoPath)try{const t=(await this.props.model.config()).options,s=Object.keys(t);if(s.indexOf("user.name")<0||s.indexOf("user.email")<0){const e=await(0,r.showDialog)({title:this.props.trans.__("Who is committing?"),body:new cs});if(!e.button.accept)return console.log("User refuses to set identity."),!1;const t=e.value;try{await this.props.model.config({"user.name":t.name,"user.email":t.email})}catch(e){if(e instanceof ue.GitResponseError)return console.log(e),!1;throw e}}this._previousRepoPath=e}catch(e){throw new Error(this.props.trans.__("Failed to set your identity. %1",e.message))}return Promise.resolve(!0)}_hasStagedFile(){return this.state.files.some((e=>"staged"===e.status||"partially-staged"===e.status))}_hasUnStagedFile(){return this.state.files.some((e=>"unstaged"===e.status||"partially-staged"===e.status))}get _markedFiles(){return this._sortedFiles.filter((e=>this.props.model.getMark(e.to)))}get _sortedFiles(){const{files:e}=this.state;return e.sort(((e,t)=>e.to.localeCompare(t.to))),e}}const nr=(0,Re.style)({display:"flex",flexDirection:"column",minWidth:"300px",color:"var(--jp-ui-font-color1)",background:"var(--jp-layout-color1)",fontSize:"var(--jp-ui-font-size1)"});class or extends r.ReactWidget{constructor(e,t,s,i,r,n){super(n),this.node.id="GitSession-root",this.addClass(nr),this._trans=r,this._commands=s,this._filebrowser=i,this._model=e,this._settings=t,e.refreshStandbyCondition=()=>!this._settings.composite.refreshIfHidden&&this.isHidden}onBeforeShow(e){this._model.refresh().catch((e=>{console.error("Fail to refresh model when displaying GitWidget.",e)})),super.onBeforeShow(e)}render(){return _.createElement(wt.Consumer,null,(e=>_.createElement(_.Fragment,null,_.createElement(rr,{commands:this._commands,filebrowser:this._filebrowser,logger:e,model:this._model,settings:this._settings,trans:this._trans}),_.createElement(r.UseSignal,{signal:e.signal,initialArgs:{message:"",level:fe.INFO}},((e,t)=>(null==t?void 0:t.message)?_.createElement(Qt,{log:t,settings:this._settings,trans:this._trans}):null)))))}}const ar={id:"@jupyterlab/git:plugin",requires:[a.IMainMenu,i.ILayoutRestorer,o.IFileBrowserFactory,l.IRenderMimeRegistry,c.ISettingRegistry,n.IDocumentManager,h.IStatusBar,d.ITranslator],provides:me,activate:async function(e,t,s,i,n,o,a,l,c){let h,b,y=null;const w=i.defaultBrowser,C=(c=c||d.nullTranslator).load("jupyterlab-git");try{h=await o.load(ar.id)}catch(e){console.error(`Failed to load settings for the Git Extension.\n${e}`)}try{b=await async function(e){try{const e="settings"+p.URLExt.objectToQueryString({version:"0.30.1"});return await ve(e,"GET")}catch(t){if(t instanceof ue.GitResponseError){const s=t.response;if(404===s.status){const t=e.__("Git server extension is unavailable. Please ensure you have installed the JupyterLab Git server extension by running: pip install --upgrade jupyterlab-git. To confirm that the server extension is installed, run: jupyter server extension list.");throw new ge.ServerConnection.ResponseError(s,t)}{const e=t.message;throw console.error("Failed to get the server extension settings",e),new ge.ServerConnection.ResponseError(s,e)}}throw t}}(C);const{frontendVersion:e,gitVersion:t,serverVersion:s}=b;if(!t)throw new Error(C.__("git command not found - please ensure you have Git > 2 installed"));{const e=t.split(".");if(Number.parseInt(e[0])<2)throw new Error(C.__("git command version must be > 2; got %1.",t))}if(e&&e!==s)throw new Error(C.__("The versions of the JupyterLab Git server frontend and backend do not match. The @jupyterlab/git frontend extension has version: %1 while the python package has version %2. Please install identical version of jupyterlab-git Python package and the @jupyterlab/git extension. Try running: pip install --upgrade jupyterlab-git",e,s))}catch(e){return console.error("Failed to load the jupyterlab-git server extension settings",e),(0,r.showErrorMessage)(C.__("Failed to load the jupyterlab-git server extension"),e.message,[r.Dialog.warnButton({label:C.__("DISMISS")})]),null}if(y=new Ee(b.serverRoot,a,e.docRegistry,h),Promise.all([e.restored,w.model.restored]).then((()=>{y.pathRepository=w.model.path})),w.model.pathChanged.connect(((e,t)=>{y.pathRepository=t.newValue})),e.serviceManager.contents.fileChanged.connect((()=>y.refreshStatus())),h){!function(e,t,s,i,n){const{commands:o,shell:a}=e;function l(e){const t=e.map((e=>_.createElement("li",{key:e.to},_.createElement("b",null,e.to))));return _.createElement("ul",null,t)}o.addCommand(be.gitSubmitCommand,{label:n.__("Commit from the Commit Box"),caption:n.__("Submit the commit using the summary and description from commit box"),execute:()=>{},isVisible:()=>!1}),o.addCommand(be.gitTerminalCommand,{label:n.__("Open Git Repository in Terminal"),caption:n.__("Open a New Terminal to the Git Repository"),execute:async e=>{const s=await o.execute("terminal:create-new",e);try{return null!==t.pathRepository&&s.content.session.send({type:"stdin",content:[`cd "${t.pathRepository.split('"').join('\\"')}"\n`]}),s}catch(e){console.error(e),s.dispose()}},isEnabled:()=>null!==t.pathRepository&&e.serviceManager.terminals.isAvailable()}),o.addCommand(be.gitUI,{label:n.__("Git Interface"),caption:n.__("Go to Git user interface"),execute:()=>{try{a.activateById("jp-git-sessions")}catch(e){console.error("Fail to open Git tab.")}}}),o.addCommand(be.gitInit,{label:n.__("Initialize a Repository"),caption:n.__("Create an empty Git repository or reinitialize an existing one"),execute:async()=>{const e=s.model.path;if((await(0,r.showDialog)({title:n.__("Initialize a Repository"),body:n.__("Do you really want to make this directory a Git Repo?"),buttons:[r.Dialog.cancelButton({label:n.__("Cancel")}),r.Dialog.warnButton({label:n.__("Yes")})]})).button.accept){vt.log({message:n.__("Initializing..."),level:fe.RUNNING});try{await t.init(e),t.pathRepository=e,vt.log({message:n.__("Git repository initialized."),level:fe.SUCCESS})}catch(e){console.error(n.__("Encountered an error when initializing the repository. Error: "),e),vt.log({message:n.__("Failed to initialize the Git repository"),level:fe.ERROR,error:e})}}},isEnabled:()=>null===t.pathRepository}),o.addCommand(be.gitOpenUrl,{label:e=>e.text,execute:e=>{const t=e.url;window.open(t)}}),o.addCommand(be.gitToggleSimpleStaging,{label:n.__("Simple staging"),isToggled:()=>!!i.composite.simpleStaging,execute:e=>{i.set("simpleStaging",!i.composite.simpleStaging)}}),o.addCommand(be.gitToggleDoubleClickDiff,{label:n.__("Double click opens diff"),isToggled:()=>!!i.composite.doubleClickDiff,execute:e=>{i.set("doubleClickDiff",!i.composite.doubleClickDiff)}}),o.addCommand(be.gitAddRemote,{label:n.__("Add Remote Repository"),caption:n.__("Add a Git remote repository"),isEnabled:()=>null!==t.pathRepository,execute:async e=>{if(null===t.pathRepository)return void console.warn(n.__("Not in a Git repository. Unable to add a remote."));let s=e.url;const i=e.name;if(!s){const e=await r.InputDialog.getText({title:n.__("Add a remote repository"),placeholder:n.__("Remote Git repository URL")});e.button.accept&&(s=e.value)}if(s)try{await t.addRemote(s,i)}catch(e){console.error(e),(0,r.showErrorMessage)(n.__("Error when adding remote repository"),e)}}}),o.addCommand(be.gitClone,{label:n.__("Clone a Repository"),caption:n.__("Clone a repository from a URL"),isEnabled:()=>null===t.pathRepository,execute:async()=>{const e=await(0,r.showDialog)({title:n.__("Clone a repo"),body:new kt(n),focusNodeSelector:"input",buttons:[r.Dialog.cancelButton({label:n.__("Cancel")}),r.Dialog.okButton({label:n.__("CLONE")})]});if(e.button.accept&&e.value){vt.log({level:fe.RUNNING,message:n.__("Cloning...")});try{const i=await Et.showGitOperationDialog(t,xt.Clone,n,{path:s.model.path,url:e.value});vt.log({message:n.__("Successfully cloned"),level:fe.SUCCESS,details:i}),await s.model.refresh()}catch(e){console.error("Encountered an error when cloning the repository. Error: ",e),vt.log({message:n.__("Failed to clone"),level:fe.ERROR,error:e})}}}}),o.addCommand(be.gitOpenGitignore,{label:n.__("Open .gitignore"),caption:n.__("Open .gitignore"),isEnabled:()=>null!==t.pathRepository,execute:async()=>{await t.ensureGitignore()}}),o.addCommand(be.gitPush,{label:n.__("Push to Remote"),caption:n.__("Push code to remote repository"),isEnabled:()=>null!==t.pathRepository,execute:async()=>{vt.log({level:fe.RUNNING,message:n.__("Pushing...")});try{const e=await Et.showGitOperationDialog(t,xt.Push,n);vt.log({message:n.__("Successfully pushed"),level:fe.SUCCESS,details:e})}catch(e){console.error(n.__("Encountered an error when pushing changes. Error: "),e),vt.log({message:n.__("Failed to push"),level:fe.ERROR,error:e})}}}),o.addCommand(be.gitPull,{label:n.__("Pull from Remote"),caption:n.__("Pull latest code from remote repository"),isEnabled:()=>null!==t.pathRepository,execute:async()=>{vt.log({level:fe.RUNNING,message:n.__("Pulling...")});try{const e=await Et.showGitOperationDialog(t,xt.Pull,n);vt.log({message:n.__("Successfully pulled"),level:fe.SUCCESS,details:e})}catch(e){console.error("Encountered an error when pulling changes. Error: ",e),vt.log({message:n.__("Failed to pull"),level:fe.ERROR,error:e})}}}),o.addCommand(be.gitShowDiff,{label:n.__("Show Diff"),caption:n.__("Display a file diff."),execute:async e=>{var t;const{model:s,isText:i}=e,o=null!==(t=xe(s.filename))&&void 0!==t?t:i&&ae;if(o){const e=`diff-${s.filename}-${s.reference.label}-${s.challenger.label}`,t=a.widgets("main");let i=t.next();for(;i;){if(i.id===e){a.activateById(e);break}i=t.next()}if(!i){const t=new f.Panel,l=new u.PromiseDelegate,c=i=new r.MainAreaWidget({content:t,reveal:l.promise});c.id=e,c.title.label=p.PathExt.basename(s.filename),c.title.caption=s.filename,c.title.icon=Ae,c.title.closable=!0,c.addClass("jp-git-diff-parent-widget"),a.add(c,"main"),a.activateById(c.id);try{const e=await o(s,c.toolbar);c.toolbar.addItem("spacer",r.Toolbar.createSpacerItem());const i=new r.ToolbarButton({label:n.__("Refresh"),onClick:async()=>{await e.refresh(),i.hide()},tooltip:n.__("Refresh diff widget"),className:"jp-git-diff-refresh"});i.hide(),c.toolbar.addItem("refresh",i),s.changed.connect((()=>{i.show()})),l.resolve(),t.addWidget(e)}catch(e){console.error(e);const t=`Load Diff Model Error (${e.message||e})`;l.reject(t)}}return i}return await(0,r.showErrorMessage)(n.__("Diff Not Supported"),n.__("Diff is not supported for %1 files.",p.PathExt.extname(s.filename).toLocaleLowerCase())),null},icon:Ae.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileOpen,{label:n.__("Open"),caption:St(n.__("Open selected file"),n.__("Open selected files")),execute:async e=>{const{files:s}=e;for(const e of s){const{x:s,y:i,to:a}=e;if("D"===s||"D"===i)return void await(0,r.showErrorMessage)(n.__("Open File Failed"),n.__("This file has been deleted!"));try{"/"!==a[a.length-1]?o.execute("docmanager:open",{path:t.getRelativeFilePath(a)}):console.log("Cannot open a folder here")}catch(e){console.error(`Fail to open ${a}.`)}}},icon:Ue.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileDiff,{label:n.__("Diff"),caption:St(n.__("Diff selected file"),n.__("Diff selected files")),execute:async s=>{const{files:i}=s;for(const s of i){const{context:i,filePath:r,isText:n,status:a}=s;if("untracked"===a)continue;const l=t.getRelativeFilePath(),c=p.PathExt.join(l,r);let h=i;if(!h){const e="staged"===a?ue.Diff.SpecialRef.INDEX:ue.Diff.SpecialRef.WORKING;h={currentRef:e,previousRef:"HEAD"}}const d=ue.Diff.SpecialRef[h.currentRef]?{special:ue.Diff.SpecialRef[h.currentRef]}:{git:h.currentRef},g=new v({challenger:{content:async()=>ve("content","POST",{filename:r,reference:d,top_repo_path:l}).then((e=>e.content)),label:ue.Diff.SpecialRef[h.currentRef]||h.currentRef,source:h.currentRef,updateAt:Date.now()},filename:c,reference:{content:async()=>ve("content","POST",{filename:r,reference:{git:h.previousRef},top_repo_path:l}).then((e=>e.content)),label:ue.Diff.SpecialRef[h.previousRef]||h.previousRef,source:h.previousRef,updateAt:Date.now()}});await o.execute(be.gitShowDiff,{model:g,isText:n})&&("HEAD"===h.previousRef&&t.headChanged.connect((()=>{g.reference=Object.assign(Object.assign({},g.reference),{updateAt:Date.now()})})),h.currentRef===ue.Diff.SpecialRef.WORKING&&e.serviceManager.contents.fileChanged.connect(((e,t)=>{const s=new Date(t.newValue.last_modified).valueOf();t.newValue.path===c&&g.challenger.updateAt!==s&&(g.challenger=Object.assign(Object.assign({},g.challenger),{updateAt:s}))})))}},icon:Ae.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileAdd,{label:n.__("Add"),caption:St(n.__("Stage or track the changes to selected file"),n.__("Stage or track the changes of selected files")),execute:async e=>{const{files:s}=e;for(const e of s)await t.add(e.to)},icon:Te.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileStage,{label:n.__("Stage"),caption:St(n.__("Stage the changes of selected file"),n.__("Stage the changes of selected files")),execute:async e=>{const{files:s}=e;for(const e of s)await t.add(e.to)},icon:Te.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileTrack,{label:n.__("Track"),caption:St(n.__("Start tracking selected file"),n.__("Start tracking selected files")),execute:async e=>{const{files:s}=e;for(const e of s)await t.add(e.to)},icon:Te.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileUnstage,{label:n.__("Unstage"),caption:St(n.__("Unstage the changes of selected file"),n.__("Unstage the changes of selected files")),execute:async e=>{const{files:s}=e;for(const e of s)"D"!==e.x&&await t.reset(e.to)},icon:Ve.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileDelete,{label:n.__("Delete"),caption:St(n.__("Delete this file"),n.__("Delete these files")),execute:async s=>{const{files:i}=s,o=l(i);if((await(0,r.showDialog)({title:n.__("Delete Files"),body:_.createElement("span",null,n.__("Are you sure you want to permanently delete the following files?               This action cannot be undone."),o),buttons:[r.Dialog.cancelButton({label:n.__("Cancel")}),r.Dialog.warnButton({label:n.__("Delete")})]})).button.accept)for(const s of i)try{await e.commands.execute("docmanager:delete-file",{path:t.getRelativeFilePath(s.to)})}catch(e){(0,r.showErrorMessage)(n.__("Deleting %1 failed.",s.to),e,[r.Dialog.warnButton({label:n.__("DISMISS")})])}},icon:g.closeIcon.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitFileDiscard,{label:n.__("Discard"),caption:St(n.__("Discard recent changes of selected file"),n.__("Discard recent changes of selected files")),execute:async e=>{const{files:s}=e,i=l(s);if((await(0,r.showDialog)({title:n.__("Discard changes"),body:_.createElement("span",null,n.__("Are you sure you want to permanently discard changes to the following files?               This action cannot be undone."),i),buttons:[r.Dialog.cancelButton({label:n.__("Cancel")}),r.Dialog.warnButton({label:n.__("Discard")})]})).button.accept)for(const e of s)try{"staged"!==e.status&&"partially-staged"!==e.status||await t.reset(e.to),("unstaged"===e.status||"partially-staged"===e.status&&"A"!==e.x)&&await t.checkout({filename:e.to})}catch(t){(0,r.showErrorMessage)(n.__("Discard changes for %1 failed.",e.to),t,[r.Dialog.warnButton({label:n.__("DISMISS")})])}},icon:ze.bindprops({stylesheet:"menuItem"})}),o.addCommand(_e.gitIgnore,{label:St(n.__("Ignore this file (add to .gitignore)"),n.__("Ignore these files (add to .gitignore)")),caption:St(n.__("Ignore this file (add to .gitignore)"),n.__("Ignore these files (add to .gitignore)")),execute:async e=>{const{files:s}=e;for(const e of s)e&&await t.ignore(e.to,!1)}}),o.addCommand(_e.gitIgnoreExtension,{label:e=>{const{files:t}=e,s=t.map((e=>p.PathExt.extname(e.to))).filter((e=>e.length>0));return n._n("Ignore %2 extension (add to .gitignore)","Ignore %2 extensions (add to .gitignore)",s.length,s.join(", "))},caption:St(n.__("Ignore this file extension (add to .gitignore)"),n.__("Ignore these files extension (add to .gitignore)")),execute:async e=>{const{files:s}=e;for(const e of s)if(e){const s=p.PathExt.extname(e.to);s.length>0&&(await(0,r.showDialog)({title:n.__("Ignore file extension"),body:n.__("Are you sure you want to ignore all %1 files within this git repository?",s),buttons:[r.Dialog.cancelButton(),r.Dialog.okButton({label:n.__("Ignore")})]})).button.label===n.__("Ignore")&&await t.ignore(e.to,!0)}},isVisible:e=>{const{files:t}=e;return t.some((e=>p.PathExt.extname(e.to).length>0))}}),o.addCommand(_e.gitNoAction,{label:n.__("No actions available"),isEnabled:()=>!1,execute:()=>{}})}(e,y,i.defaultBrowser,h,C);const n=new or(y,h,e.commands,i.defaultBrowser.model,C);n.id="jp-git-sessions",n.title.icon=Ie,n.title.caption="Git",s.add(n,"git-sessions"),e.shell.add(n,"left",{rank:200}),t.addMenu(function(e,t){const s=[{text:t.__("Set Up Remotes"),url:"https://www.atlassian.com/git/tutorials/setting-up-a-repository"},{text:t.__("Git Documentation"),url:"https://git-scm.com/doc"}],i=new f.Menu({commands:e});i.title.label="Git",[be.gitInit,be.gitClone,be.gitPush,be.gitPull,be.gitAddRemote,be.gitTerminalCommand].forEach((e=>{i.addItem({command:e})})),i.addItem({type:"separator"}),i.addItem({command:be.gitToggleSimpleStaging}),i.addItem({command:be.gitToggleDoubleClickDiff}),i.addItem({type:"separator"}),i.addItem({command:be.gitOpenGitignore}),i.addItem({type:"separator"});const r=new f.Menu({commands:e});return r.title.label=t.__(" Help "),s.map((e=>{r.addItem({args:e,command:be.gitOpenUrl})})),i.addItem({type:"submenu",submenu:r}),i}(e.commands,C),{rank:60}),function(e,t,s){t.toolbar.addItem("gitClone",r.ReactWidget.create(_.createElement(r.UseSignal,{signal:e.repositoryChanged,initialArgs:{name:"pathRepository",oldValue:null,newValue:e.pathRepository}},((e,t)=>_.createElement(r.ToolbarButtonComponent,{enabled:null===t.newValue,icon:Pe,onClick:()=>{s.execute(be.gitClone)},tooltip:"Git Clone"})))))}(y,i.defaultBrowser,e.commands),function(e,t,s,i){const r=new Lt(i);e.registerStatusItem("git-status",{align:"left",item:r,isActive:At.isStatusWidgetActive(s),activeStateChanged:s&&s.changed}),t.taskChanged.connect(At.createEventCallback(r))}(l,y,h,C),function(e,t,s,i){class r extends f.Menu{onBeforeAttach(t){this.updateItems();const s=e.status;e.refreshStatus().then((()=>{e.status!==s&&this.updateItems()})).catch((e=>{console.error("Fail to refresh model when displaying git context menu.",e)})),super.onBeforeAttach(t)}updateItems(){const s=this.isVisible,i=this.parentMenu,r=function(){const e=t.currentWidget;return e?(0,m.toArray)(e.selectedItems()):[]}(),n=new Set(r.map((t=>{var s;return null===(s=e.getFile(t.path))||void 0===s?void 0:s.status})).filter((e=>void 0!==e))),o=new Set([].concat(...[...n].map((e=>_t[e]))).filter((e=>e!==_e.gitFileOpen&&e!==_e.gitFileDelete&&void 0!==e)).map((e=>e===_e.gitFileStage||e===_e.gitFileTrack?_e.gitFileAdd:e)));0===o.size&&0===n.size&&o.add(_e.gitNoAction);const a=!this._commands||this._commands.length!==o.size||!this._commands.every((e=>o.has(e))),l=r.map((e=>e.path)),c=!this._paths||!m.ArrayExt.shallowEqual(this._paths,l);if(a||c){const t=[...o];this.clearItems(),Ft(t,this,l.map((t=>e.getFile(t))).filter((e=>void 0!==e))),s&&i.triggerActiveItem(),this._commands=t,this._paths=l}}onBeforeShow(e){super.onBeforeShow(e)}}const n=new r({commands:s});n.title.label="Git",n.title.icon=Ie.bindprops({stylesheet:"menuItem"}),i.addItem({type:"submenu",submenu:n,selector:'.jp-DirListing-item[data-isdir="false"]',rank:5})}(y,i.tracker,e.commands,e.contextMenu)}return y.registerDiffProvider("Nbdime",[".ipynb"],((e,t)=>(async(e,t,s)=>{const i=new Bt(e,t);if(i.addClass("jp-git-diff-root"),await i.ready,s){const e=document.createElement("input"),t=document.createElement("label");e.className="nbdime-hide-unchanged",e.type="checkbox",e.checked=!0,t.appendChild(e),t.appendChild(document.createElement("span")).textContent="Hide unchanged cells",s.addItem("hideUnchanged",new f.Widget({node:t})),i.areUnchangedCellsHidden=e.checked,e.onchange=()=>{i.areUnchangedCellsHidden=e.checked}}return i})(e,n,t))),y},autoStart:!0},lr=ar}}]);